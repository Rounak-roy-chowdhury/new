{"platform":{"name":"ubuntu","release":"20.04","target_id":"9388f861-9900-5483-b8fb-0e08ef063a8d"},"profiles":[{"name":"linux-baseline","version":"2.8.3","sha256":"6fed5e5e13a2ef1837550e7819fef7b6f0ba00d68b228f55323887c896d07263","title":"DevSec Linux Security Baseline","maintainer":"DevSec Hardening Framework Team","summary":"Test suite for best practice Linux OS hardening","license":"Apache-2.0","copyright":"DevSec Hardening Framework Team","copyright_email":"hello@dev-sec.io","supports":[{"platform-family":"linux"}],"attributes":[{"name":"login_defs_umask","options":{"value":"027"}},{"name":"login_defs_passmaxdays","options":{"value":"60"}},{"name":"login_defs_passmindays","options":{"value":"7"}},{"name":"login_defs_passwarnage","options":{"value":"7"}},{"name":"blacklist","options":{"value":["/usr/bin/rcp","/usr/bin/rlogin","/usr/bin/rsh","/usr/libexec/openssh/ssh-keysign","/usr/lib/openssh/ssh-keysign","/sbin/netreport","/usr/sbin/usernetctl","/usr/sbin/userisdnctl","/usr/sbin/pppd","/usr/bin/lockfile","/usr/bin/mail-lock","/usr/bin/mail-unlock","/usr/bin/mail-touchlock","/usr/bin/dotlockfile","/usr/bin/arping","/usr/sbin/arping","/usr/sbin/uuidd","/usr/bin/mtr","/usr/lib/evolution/camel-lock-helper-1.2","/usr/lib/pt_chown","/usr/lib/eject/dmcrypt-get-device","/usr/lib/mc/cons.saver"]}},{"name":"mount_exec_blocklist","options":{"value":["/boot","/dev","/dev/shm","/tmp","/var/log","/var/log/audit","/var/tmp"]}},{"name":"mount_suid_blocklist","options":{"value":["/boot","/dev","/dev/shm","/home","/run","/tmp","/var","/var/log","/var/log/audit","/var/tmp"]}},{"name":"mount_dev_blocklist","options":{"value":["/boot","/dev/shm","/home","/run","/tmp","/var","/var/log","/var/log/audit","/var/tmp"]}},{"name":"sysctl_forwarding","options":{"value":false}},{"name":"kernel_modules_disabled","options":{"value":0}}],"groups":[{"id":"controls/package_spec.rb","controls":["package-01","package-02","package-03","package-05","package-06","package-08","package-09"]},{"id":"controls/os_spec.rb","controls":["os-01","os-02","os-03","os-03b","os-04","os-05","os-05b","os-06","os-07","os-08","os-09","os-10","os-11","os-12","os-13","os-14","os-15","os-16"]},{"id":"controls/sysctl_spec.rb","controls":["sysctl-01","sysctl-02","sysctl-03","sysctl-04","sysctl-05","sysctl-06","sysctl-07","sysctl-08","sysctl-09","sysctl-10","sysctl-11","sysctl-12","sysctl-13","sysctl-14","sysctl-15","sysctl-16","sysctl-17","sysctl-19","sysctl-20","sysctl-21","sysctl-22","sysctl-23","sysctl-24","sysctl-25","sysctl-26","sysctl-27","sysctl-28","sysctl-29","sysctl-30","sysctl-31a","sysctl-31b","sysctl-32","sysctl-33","sysctl-34"]}],"controls":[{"id":"os-01","title":"Trusted hosts login","desc":"hosts.equiv file is a weak implemenation of authentication. Disabling the hosts.equiv support helps to prevent users from subverting the system's normal access control mechanisms of the system.","descriptions":[{"label":"default","data":"hosts.equiv file is a weak implemenation of authentication. Disabling the hosts.equiv support helps to prevent users from subverting the system's normal access control mechanisms of the system."}],"impact":1.0,"refs":[],"tags":{},"code":"control 'os-01' do\n  impact 1.0\n  title 'Trusted hosts login'\n  desc \"hosts.equiv file is a weak implemenation of authentication. Disabling the hosts.equiv support helps to prevent users from subverting the system's normal access control mechanisms of the system.\"\n  describe file('/etc/hosts.equiv') do\n    it { should_not exist }\n  end\nend\n","source_location":{"line":78,"ref":"linux-baseline/controls/os_spec.rb"},"waiver_data":{},"results":[{"status":"passed","code_desc":"File /etc/hosts.equiv is expected not to exist","run_time":0.046128196,"start_time":"2022-05-11T09:57:18+00:00","resource_class":"file","resource_params":"[\"/etc/hosts.equiv\"]","resource_id":""}]},{"id":"os-02","title":"Check owner and permissions for /etc/shadow","desc":"Check periodically the owner and permissions for /etc/shadow","descriptions":[{"label":"default","data":"Check periodically the owner and permissions for /etc/shadow"}],"impact":1.0,"refs":[],"tags":{},"code":"control 'os-02' do\n  impact 1.0\n  title 'Check owner and permissions for /etc/shadow'\n  desc 'Check periodically the owner and permissions for /etc/shadow'\n  describe file('/etc/shadow') do\n    it { should exist }\n    it { should be_file }\n    it { should be_owned_by 'root' }\n    its('group') { should eq shadow_group }\n    it { should_not be_executable }\n    it { should_not be_readable.by('other') }\n  end\n  if os.redhat? || os.name == 'fedora'\n    describe file('/etc/shadow') do\n      it { should_not be_writable.by('owner') }\n      it { should_not be_readable.by('owner') }\n    end\n  else\n    describe file('/etc/shadow') do\n      it { should be_writable.by('owner') }\n      it { should be_readable.by('owner') }\n    end\n  end\n  if os.debian? || os.suse?\n    describe file('/etc/shadow') do\n      it { should be_readable.by('group') }\n    end\n  else\n    describe file('/etc/shadow') do\n      it { should_not be_readable.by('group') }\n    end\n  end\nend\n","source_location":{"line":87,"ref":"linux-baseline/controls/os_spec.rb"},"waiver_data":{},"results":[{"status":"passed","code_desc":"File /etc/shadow is expected to exist","run_time":0.004387928,"start_time":"2022-05-11T09:57:18+00:00","resource_class":"file","resource_params":"[\"/etc/shadow\"]","resource_id":""},{"status":"passed","code_desc":"File /etc/shadow is expected to be file","run_time":0.022019141,"start_time":"2022-05-11T09:57:18+00:00","resource_class":"file","resource_params":"[\"/etc/shadow\"]","resource_id":""},{"status":"passed","code_desc":"File /etc/shadow is expected to be owned by \"root\"","run_time":0.010678068,"start_time":"2022-05-11T09:57:18+00:00","resource_class":"file","resource_params":"[\"/etc/shadow\"]","resource_id":""},{"status":"passed","code_desc":"File /etc/shadow is expected not to be executable","run_time":0.000209101,"start_time":"2022-05-11T09:57:18+00:00","resource_class":"file","resource_params":"[\"/etc/shadow\"]","resource_id":""},{"status":"passed","code_desc":"File /etc/shadow is expected not to be readable by other","run_time":0.000104601,"start_time":"2022-05-11T09:57:18+00:00","resource_class":"file","resource_params":"[\"/etc/shadow\"]","resource_id":""},{"status":"passed","code_desc":"File /etc/shadow group is expected to eq \"shadow\"","run_time":0.002021913,"start_time":"2022-05-11T09:57:18+00:00","resource_class":"file","resource_params":"[\"/etc/shadow\"]","resource_id":""},{"status":"passed","code_desc":"File /etc/shadow is expected to be writable by owner","run_time":0.000155701,"start_time":"2022-05-11T09:57:18+00:00","resource_class":"file","resource_params":"[\"/etc/shadow\"]","resource_id":""},{"status":"passed","code_desc":"File /etc/shadow is expected to be readable by owner","run_time":9.5301e-05,"start_time":"2022-05-11T09:57:18+00:00","resource_class":"file","resource_params":"[\"/etc/shadow\"]","resource_id":""},{"status":"passed","code_desc":"File /etc/shadow is expected to be readable by group","run_time":9.04e-05,"start_time":"2022-05-11T09:57:18+00:00","resource_class":"file","resource_params":"[\"/etc/shadow\"]","resource_id":""}]},{"id":"os-03","title":"Check owner and permissions for /etc/passwd","desc":"Check periodically the owner and permissions for /etc/passwd","descriptions":[{"label":"default","data":"Check periodically the owner and permissions for /etc/passwd"}],"impact":1.0,"refs":[],"tags":{},"code":"control 'os-03' do\n  impact 1.0\n  title 'Check owner and permissions for /etc/passwd'\n  desc 'Check periodically the owner and permissions for /etc/passwd'\n  describe file('/etc/passwd') do\n    it { should exist }\n    it { should be_file }\n    it { should be_owned_by 'root' }\n    its('group') { should eq 'root' }\n    it { should_not be_executable }\n    it { should be_writable.by('owner') }\n    it { should_not be_writable.by('group') }\n    it { should_not be_writable.by('other') }\n    it { should be_readable.by('owner') }\n    it { should be_readable.by('group') }\n    it { should be_readable.by('other') }\n  end\nend\n","source_location":{"line":121,"ref":"linux-baseline/controls/os_spec.rb"},"waiver_data":{},"results":[{"status":"passed","code_desc":"File /etc/passwd is expected to exist","run_time":0.004211627,"start_time":"2022-05-11T09:57:18+00:00","resource_class":"file","resource_params":"[\"/etc/passwd\"]","resource_id":""},{"status":"passed","code_desc":"File /etc/passwd is expected to be file","run_time":0.003690824,"start_time":"2022-05-11T09:57:18+00:00","resource_class":"file","resource_params":"[\"/etc/passwd\"]","resource_id":""},{"status":"passed","code_desc":"File /etc/passwd is expected to be owned by \"root\"","run_time":0.003632923,"start_time":"2022-05-11T09:57:18+00:00","resource_class":"file","resource_params":"[\"/etc/passwd\"]","resource_id":""},{"status":"passed","code_desc":"File /etc/passwd is expected not to be executable","run_time":0.0001422,"start_time":"2022-05-11T09:57:18+00:00","resource_class":"file","resource_params":"[\"/etc/passwd\"]","resource_id":""},{"status":"passed","code_desc":"File /etc/passwd is expected to be writable by owner","run_time":8.84e-05,"start_time":"2022-05-11T09:57:18+00:00","resource_class":"file","resource_params":"[\"/etc/passwd\"]","resource_id":""},{"status":"passed","code_desc":"File /etc/passwd is expected not to be writable by group","run_time":0.000115301,"start_time":"2022-05-11T09:57:18+00:00","resource_class":"file","resource_params":"[\"/etc/passwd\"]","resource_id":""},{"status":"passed","code_desc":"File /etc/passwd is expected not to be writable by other","run_time":8.6801e-05,"start_time":"2022-05-11T09:57:18+00:00","resource_class":"file","resource_params":"[\"/etc/passwd\"]","resource_id":""},{"status":"passed","code_desc":"File /etc/passwd is expected to be readable by owner","run_time":8.2901e-05,"start_time":"2022-05-11T09:57:18+00:00","resource_class":"file","resource_params":"[\"/etc/passwd\"]","resource_id":""},{"status":"passed","code_desc":"File /etc/passwd is expected to be readable by group","run_time":0.0001113,"start_time":"2022-05-11T09:57:18+00:00","resource_class":"file","resource_params":"[\"/etc/passwd\"]","resource_id":""},{"status":"passed","code_desc":"File /etc/passwd is expected to be readable by other","run_time":7.58e-05,"start_time":"2022-05-11T09:57:18+00:00","resource_class":"file","resource_params":"[\"/etc/passwd\"]","resource_id":""},{"status":"passed","code_desc":"File /etc/passwd group is expected to eq \"root\"","run_time":9.6601e-05,"start_time":"2022-05-11T09:57:18+00:00","resource_class":"file","resource_params":"[\"/etc/passwd\"]","resource_id":""}]},{"id":"os-03b","title":"Check passwords hashes in /etc/passwd","desc":"Check periodically that /etc/passwd does not contain passwords","descriptions":[{"label":"default","data":"Check periodically that /etc/passwd does not contain passwords"}],"impact":1.0,"refs":[],"tags":{},"code":"control 'os-03b' do\n  impact 1.0\n  title 'Check passwords hashes in /etc/passwd'\n  desc 'Check periodically that /etc/passwd does not contain passwords'\n  describe passwd do\n    its('passwords') { should be_in ['x', '*'] }\n  end\nend\n","source_location":{"line":140,"ref":"linux-baseline/controls/os_spec.rb"},"waiver_data":{},"results":[{"status":"passed","code_desc":"/etc/passwd passwords is expected to be in \"x\" and \"*\"","run_time":0.000193901,"start_time":"2022-05-11T09:57:18+00:00","resource_class":"passwd","resource_params":"[]","resource_id":""}]},{"id":"os-04","title":"Dot in PATH variable","desc":"Do not include the current working directory in PATH variable. This makes it easier for an attacker to gain extensive rights by executing a Trojan program","descriptions":[{"label":"default","data":"Do not include the current working directory in PATH variable. This makes it easier for an attacker to gain extensive rights by executing a Trojan program"}],"impact":1.0,"refs":[],"tags":{},"code":"control 'os-04' do\n  impact 1.0\n  title 'Dot in PATH variable'\n  desc 'Do not include the current working directory in PATH variable. This makes it easier for an attacker to gain extensive rights by executing a Trojan program'\n  describe os_env('PATH') do\n    its('split') { should_not include('') }\n    its('split') { should_not include('.') }\n  end\nend\n","source_location":{"line":149,"ref":"linux-baseline/controls/os_spec.rb"},"waiver_data":{},"results":[{"status":"passed","code_desc":"Environment variable PATH split is expected not to include \"\"","run_time":0.038889449,"start_time":"2022-05-11T09:57:18+00:00","resource_class":"os_env","resource_params":"[\"PATH\"]","resource_id":""},{"status":"passed","code_desc":"Environment variable PATH split is expected not to include \".\"","run_time":0.000241402,"start_time":"2022-05-11T09:57:18+00:00","resource_class":"os_env","resource_params":"[\"PATH\"]","resource_id":""}]},{"id":"os-05","title":"Check login.defs","desc":"Check owner and permissions for login.defs. Also check the configured PATH variable and umask in login.defs","descriptions":[{"label":"default","data":"Check owner and permissions for login.defs. Also check the configured PATH variable and umask in login.defs"}],"impact":1.0,"refs":[],"tags":{},"code":"control 'os-05' do\n  impact 1.0\n  title 'Check login.defs'\n  desc 'Check owner and permissions for login.defs. Also check the configured PATH variable and umask in login.defs'\n  describe file('/etc/login.defs') do\n    it { should exist }\n    it { should be_file }\n    it { should be_owned_by 'root' }\n    its('group') { should eq 'root' }\n    it { should_not be_executable }\n    it { should be_readable.by('owner') }\n    it { should be_readable.by('group') }\n    it { should be_readable.by('other') }\n  end\n  describe login_defs do\n    its('ENV_SUPATH') { should include('/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin') }\n    its('ENV_PATH') { should include('/usr/local/bin:/usr/bin:/bin') }\n    its('UMASK') { should include(login_defs_umask) }\n    its('PASS_MAX_DAYS') { should eq login_defs_passmaxdays }\n    its('PASS_MIN_DAYS') { should eq login_defs_passmindays }\n    its('PASS_WARN_AGE') { should eq login_defs_passwarnage }\n    its('LOGIN_RETRIES') { should eq '5' }\n    its('LOGIN_TIMEOUT') { should eq '60' }\n    its('UID_MIN') { should eq '1000' }\n    its('GID_MIN') { should eq '1000' }\n  end\nend\n","source_location":{"line":159,"ref":"linux-baseline/controls/os_spec.rb"},"waiver_data":{},"results":[{"status":"passed","code_desc":"File /etc/login.defs is expected to exist","run_time":0.004171826,"start_time":"2022-05-11T09:57:18+00:00","resource_class":"file","resource_params":"[\"/etc/login.defs\"]","resource_id":""},{"status":"passed","code_desc":"File /etc/login.defs is expected to be file","run_time":0.004166426,"start_time":"2022-05-11T09:57:18+00:00","resource_class":"file","resource_params":"[\"/etc/login.defs\"]","resource_id":""},{"status":"passed","code_desc":"File /etc/login.defs is expected to be owned by \"root\"","run_time":0.003857125,"start_time":"2022-05-11T09:57:18+00:00","resource_class":"file","resource_params":"[\"/etc/login.defs\"]","resource_id":""},{"status":"passed","code_desc":"File /etc/login.defs is expected not to be executable","run_time":0.000173801,"start_time":"2022-05-11T09:57:18+00:00","resource_class":"file","resource_params":"[\"/etc/login.defs\"]","resource_id":""},{"status":"passed","code_desc":"File /etc/login.defs is expected to be readable by owner","run_time":9.3701e-05,"start_time":"2022-05-11T09:57:18+00:00","resource_class":"file","resource_params":"[\"/etc/login.defs\"]","resource_id":""},{"status":"passed","code_desc":"File /etc/login.defs is expected to be readable by group","run_time":0.000122801,"start_time":"2022-05-11T09:57:18+00:00","resource_class":"file","resource_params":"[\"/etc/login.defs\"]","resource_id":""},{"status":"passed","code_desc":"File /etc/login.defs is expected to be readable by other","run_time":8.1001e-05,"start_time":"2022-05-11T09:57:18+00:00","resource_class":"file","resource_params":"[\"/etc/login.defs\"]","resource_id":""},{"status":"passed","code_desc":"File /etc/login.defs group is expected to eq \"root\"","run_time":0.000100401,"start_time":"2022-05-11T09:57:18+00:00","resource_class":"file","resource_params":"[\"/etc/login.defs\"]","resource_id":""},{"status":"passed","code_desc":"login.defs ENV_SUPATH is expected to include \"/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\"","run_time":0.001085807,"start_time":"2022-05-11T09:57:18+00:00","resource_class":"login_defs","resource_params":"[]","resource_id":""},{"status":"passed","code_desc":"login.defs ENV_PATH is expected to include \"/usr/local/bin:/usr/bin:/bin\"","run_time":0.000108201,"start_time":"2022-05-11T09:57:18+00:00","resource_class":"login_defs","resource_params":"[]","resource_id":""},{"status":"failed","code_desc":"login.defs UMASK is expected to include \"027\"","run_time":0.000327302,"start_time":"2022-05-11T09:57:18+00:00","message":"expected \"022\" to include \"027\"","resource_class":"login_defs","resource_params":"[]","resource_id":""},{"status":"failed","code_desc":"login.defs PASS_MAX_DAYS is expected to eq \"60\"","run_time":0.000139201,"start_time":"2022-05-11T09:57:18+00:00","message":"\nexpected: \"60\"\n     got: \"99999\"\n\n(compared using ==)\n","resource_class":"login_defs","resource_params":"[]","resource_id":""},{"status":"failed","code_desc":"login.defs PASS_MIN_DAYS is expected to eq \"7\"","run_time":0.000114601,"start_time":"2022-05-11T09:57:18+00:00","message":"\nexpected: \"7\"\n     got: \"0\"\n\n(compared using ==)\n","resource_class":"login_defs","resource_params":"[]","resource_id":""},{"status":"passed","code_desc":"login.defs PASS_WARN_AGE is expected to eq \"7\"","run_time":0.000106201,"start_time":"2022-05-11T09:57:18+00:00","resource_class":"login_defs","resource_params":"[]","resource_id":""},{"status":"passed","code_desc":"login.defs LOGIN_RETRIES is expected to eq \"5\"","run_time":7.8601e-05,"start_time":"2022-05-11T09:57:18+00:00","resource_class":"login_defs","resource_params":"[]","resource_id":""},{"status":"passed","code_desc":"login.defs LOGIN_TIMEOUT is expected to eq \"60\"","run_time":7.3901e-05,"start_time":"2022-05-11T09:57:18+00:00","resource_class":"login_defs","resource_params":"[]","resource_id":""},{"status":"passed","code_desc":"login.defs UID_MIN is expected to eq \"1000\"","run_time":7.06e-05,"start_time":"2022-05-11T09:57:18+00:00","resource_class":"login_defs","resource_params":"[]","resource_id":""},{"status":"passed","code_desc":"login.defs GID_MIN is expected to eq \"1000\"","run_time":7.6201e-05,"start_time":"2022-05-11T09:57:18+00:00","resource_class":"login_defs","resource_params":"[]","resource_id":""}]},{"id":"os-05b","title":"Check login.defs - RedHat specific","desc":"Check owner and permissions for login.defs. Also check the configured PATH variable and umask in login.defs","descriptions":[{"label":"default","data":"Check owner and permissions for login.defs. Also check the configured PATH variable and umask in login.defs"}],"impact":1.0,"refs":[],"tags":{},"code":"control 'os-05b' do\n  impact 1.0\n  title 'Check login.defs - RedHat specific'\n  desc 'Check owner and permissions for login.defs. Also check the configured PATH variable and umask in login.defs'\n  describe file('/etc/login.defs') do\n    it { should_not be_writable }\n  end\n  describe login_defs do\n    its('SYS_UID_MIN') { should eq '201' }\n    its('SYS_UID_MAX') { should eq '999' }\n    its('SYS_GID_MIN') { should eq '201' }\n    its('SYS_GID_MAX') { should eq '999' }\n  end\n  only_if { os.redhat? }\nend\n","source_location":{"line":187,"ref":"linux-baseline/controls/os_spec.rb"},"waiver_data":{},"results":[{"status":"skipped","code_desc":"No-op","run_time":8.4e-06,"start_time":"2022-05-11T09:57:18+00:00","resource":"No-op","skip_message":"Skipped control due to only_if condition.","resource_class":"noop","resource_params":"[]","resource_id":""}]},{"id":"os-06","title":"Check for SUID/ SGID blacklist","desc":"Find blacklisted SUID and SGID files to ensure that no rogue SUID and SGID files have been introduced into the system","descriptions":[{"label":"default","data":"Find blacklisted SUID and SGID files to ensure that no rogue SUID and SGID files have been introduced into the system"}],"impact":1.0,"refs":[],"tags":{},"code":"control 'os-06' do\n  impact 1.0\n  title 'Check for SUID/ SGID blacklist'\n  desc 'Find blacklisted SUID and SGID files to ensure that no rogue SUID and SGID files have been introduced into the system'\n\n  describe suid_check(blacklist) do\n    its('diff') { should be_empty }\n  end\nend\n","source_location":{"line":203,"ref":"linux-baseline/controls/os_spec.rb"},"waiver_data":{},"results":[{"status":"passed","code_desc":"suid_check diff is expected to be empty","run_time":0.432387372,"start_time":"2022-05-11T09:57:18+00:00","resource_class":"suid_check","resource_params":"[[\"/usr/bin/rcp\", \"/usr/bin/rlogin\", \"/usr/bin/rsh\", \"/usr/libexec/openssh/ssh-keysign\", \"/usr/lib/openssh/ssh-keysign\", \"/sbin/netreport\", \"/usr/sbin/usernetctl\", \"/usr/sbin/userisdnctl\", \"/usr/sbin/pppd\", \"/usr/bin/lockfile\", \"/usr/bin/mail-lock\", \"/usr/bin/mail-unlock\", \"/usr/bin/mail-touchlock\", \"/usr/bin/dotlockfile\", \"/usr/bin/arping\", \"/usr/sbin/arping\", \"/usr/sbin/uuidd\", \"/usr/bin/mtr\", \"/usr/lib/evolution/camel-lock-helper-1.2\", \"/usr/lib/pt_chown\", \"/usr/lib/eject/dmcrypt-get-device\", \"/usr/lib/mc/cons.saver\"]]","resource_id":""}]},{"id":"os-07","title":"Unique uid and gid","desc":"Check for unique uids gids","descriptions":[{"label":"default","data":"Check for unique uids gids"}],"impact":1.0,"refs":[],"tags":{},"code":"control 'os-07' do\n  impact 1.0\n  title 'Unique uid and gid'\n  desc 'Check for unique uids gids'\n  describe passwd do\n    its('uids') { should_not contain_duplicates }\n  end\n  describe etc_group do\n    its('gids') { should_not contain_duplicates }\n  end\nend\n","source_location":{"line":213,"ref":"linux-baseline/controls/os_spec.rb"},"waiver_data":{},"results":[{"status":"passed","code_desc":"/etc/passwd uids is expected not to contain duplicates","run_time":0.000428202,"start_time":"2022-05-11T09:57:18+00:00","resource_class":"passwd","resource_params":"[]","resource_id":""},{"status":"passed","code_desc":"/etc/group gids is expected not to contain duplicates","run_time":0.000345402,"start_time":"2022-05-11T09:57:18+00:00","resource_class":"etc_group","resource_params":"[]","resource_id":""}]},{"id":"os-08","title":"Entropy","desc":"Check system has enough entropy - greater than 1000","descriptions":[{"label":"default","data":"Check system has enough entropy - greater than 1000"}],"impact":1.0,"refs":[],"tags":{},"code":"control 'os-08' do\n  impact 1.0\n  title 'Entropy'\n  desc 'Check system has enough entropy - greater than 1000'\n  describe file('/proc/sys/kernel/random/entropy_avail').content.to_i do\n    it { should >= 1000 }\n  end\nend\n","source_location":{"line":225,"ref":"linux-baseline/controls/os_spec.rb"},"waiver_data":{},"results":[{"status":"passed","code_desc":"2655 is expected to >= 1000","run_time":0.009118059,"start_time":"2022-05-11T09:57:18+00:00","resource_class":"Numeric","resource_params":"[]","resource_id":""}]},{"id":"os-09","title":"Check for .rhosts and .netrc file","desc":"Find .rhosts and .netrc files - CIS Benchmark 9.2.9-10","descriptions":[{"label":"default","data":"Find .rhosts and .netrc files - CIS Benchmark 9.2.9-10"}],"impact":1.0,"refs":[],"tags":{},"code":"control 'os-09' do\n  impact 1.0\n  title 'Check for .rhosts and .netrc file'\n  desc 'Find .rhosts and .netrc files - CIS Benchmark 9.2.9-10'\n  output = command('find / -maxdepth 3 \\( -iname .rhosts -o -iname .netrc \\) -print 2>/dev/null | grep -v \\'^find:\\'')\n  out = output.stdout.split(/\\r?\\n/)\n  describe out do\n    it { should be_empty }\n  end\nend\n","source_location":{"line":234,"ref":"linux-baseline/controls/os_spec.rb"},"waiver_data":{},"results":[{"status":"passed","code_desc":"[] is expected to be empty","run_time":0.004115926,"start_time":"2022-05-11T09:57:18+00:00","resource_class":"Object","resource_params":"[]","resource_id":""}]},{"id":"os-10","title":"CIS: Disable unused filesystems","desc":"1.1.1 Ensure mounting of cramfs, freevxfs, jffs2, hfs, hfsplus, squashfs, udf, FAT","descriptions":[{"label":"default","data":"1.1.1 Ensure mounting of cramfs, freevxfs, jffs2, hfs, hfsplus, squashfs, udf, FAT"}],"impact":1.0,"refs":[],"tags":{},"code":"control 'os-10' do\n  impact 1.0\n  title 'CIS: Disable unused filesystems'\n  desc '1.1.1 Ensure mounting of cramfs, freevxfs, jffs2, hfs, hfsplus, squashfs, udf, FAT'\n  only_if { !container_execution }\n  efi_dir = inspec.file('/sys/firmware/efi')\n  describe file('/etc/modprobe.d/dev-sec.conf') do\n    its(:content) { should match 'install cramfs /bin/true' }\n    its(:content) { should match 'install freevxfs /bin/true' }\n    its(:content) { should match 'install jffs2 /bin/true' }\n    its(:content) { should match 'install hfs /bin/true' }\n    its(:content) { should match 'install hfsplus /bin/true' }\n    its(:content) { should match 'install squashfs /bin/true' }\n    its(:content) { should match 'install udf /bin/true' }\n    # if efi is active, do not disable vfat. otherwise the system\n    # won't boot anymore\n    unless efi_dir.exist?\n      its(:content) { should match 'install vfat /bin/true' }\n    end\n  end\nend\n","source_location":{"line":245,"ref":"linux-baseline/controls/os_spec.rb"},"waiver_data":{},"results":[{"status":"failed","code_desc":"File /etc/modprobe.d/dev-sec.conf content is expected to match \"install cramfs /bin/true\"","run_time":0.05608926,"start_time":"2022-05-11T09:57:18+00:00","message":"expected nil to match \"install cramfs /bin/true\"","resource_class":"file","resource_params":"[\"/etc/modprobe.d/dev-sec.conf\"]","resource_id":""},{"status":"failed","code_desc":"File /etc/modprobe.d/dev-sec.conf content is expected to match \"install freevxfs /bin/true\"","run_time":0.000284802,"start_time":"2022-05-11T09:57:18+00:00","message":"expected nil to match \"install freevxfs /bin/true\"","resource_class":"file","resource_params":"[\"/etc/modprobe.d/dev-sec.conf\"]","resource_id":""},{"status":"failed","code_desc":"File /etc/modprobe.d/dev-sec.conf content is expected to match \"install jffs2 /bin/true\"","run_time":0.000133601,"start_time":"2022-05-11T09:57:18+00:00","message":"expected nil to match \"install jffs2 /bin/true\"","resource_class":"file","resource_params":"[\"/etc/modprobe.d/dev-sec.conf\"]","resource_id":""},{"status":"failed","code_desc":"File /etc/modprobe.d/dev-sec.conf content is expected to match \"install hfs /bin/true\"","run_time":0.0001017,"start_time":"2022-05-11T09:57:18+00:00","message":"expected nil to match \"install hfs /bin/true\"","resource_class":"file","resource_params":"[\"/etc/modprobe.d/dev-sec.conf\"]","resource_id":""},{"status":"failed","code_desc":"File /etc/modprobe.d/dev-sec.conf content is expected to match \"install hfsplus /bin/true\"","run_time":9.8101e-05,"start_time":"2022-05-11T09:57:18+00:00","message":"expected nil to match \"install hfsplus /bin/true\"","resource_class":"file","resource_params":"[\"/etc/modprobe.d/dev-sec.conf\"]","resource_id":""},{"status":"failed","code_desc":"File /etc/modprobe.d/dev-sec.conf content is expected to match \"install squashfs /bin/true\"","run_time":0.000103301,"start_time":"2022-05-11T09:57:18+00:00","message":"expected nil to match \"install squashfs /bin/true\"","resource_class":"file","resource_params":"[\"/etc/modprobe.d/dev-sec.conf\"]","resource_id":""},{"status":"failed","code_desc":"File /etc/modprobe.d/dev-sec.conf content is expected to match \"install udf /bin/true\"","run_time":9.7001e-05,"start_time":"2022-05-11T09:57:18+00:00","message":"expected nil to match \"install udf /bin/true\"","resource_class":"file","resource_params":"[\"/etc/modprobe.d/dev-sec.conf\"]","resource_id":""}]},{"id":"os-11","title":"Protect log-directory","desc":"The log-directory /var/log should belong to root","descriptions":[{"label":"default","data":"The log-directory /var/log should belong to root"}],"impact":1.0,"refs":[],"tags":{},"code":"control 'os-11' do\n  impact 1.0\n  title 'Protect log-directory'\n  desc 'The log-directory /var/log should belong to root'\n  describe file('/var/log') do\n    it { should be_directory }\n    it { should be_owned_by 'root' }\n    its(:group) { should match(/^root|syslog$/) }\n  end\nend\n","source_location":{"line":267,"ref":"linux-baseline/controls/os_spec.rb"},"waiver_data":{},"results":[{"status":"passed","code_desc":"File /var/log is expected to be directory","run_time":0.016761608,"start_time":"2022-05-11T09:57:18+00:00","resource_class":"file","resource_params":"[\"/var/log\"]","resource_id":""},{"status":"passed","code_desc":"File /var/log is expected to be owned by \"root\"","run_time":0.005162633,"start_time":"2022-05-11T09:57:18+00:00","resource_class":"file","resource_params":"[\"/var/log\"]","resource_id":""},{"status":"passed","code_desc":"File /var/log group is expected to match /^root|syslog$/","run_time":0.000139501,"start_time":"2022-05-11T09:57:18+00:00","resource_class":"file","resource_params":"[\"/var/log\"]","resource_id":""}]},{"id":"os-12","title":"Detect vulnerabilities in the cpu-vulnerability-directory","desc":"Check for known cpu vulnerabilities described here: https://www.kernel.org/doc/html/v5.6/admin-guide/hw-vuln/index.html","descriptions":[{"label":"default","data":"Check for known cpu vulnerabilities described here: https://www.kernel.org/doc/html/v5.6/admin-guide/hw-vuln/index.html"}],"impact":1.0,"refs":[],"tags":{},"code":"control 'os-12' do\n  impact 1.0\n  title 'Detect vulnerabilities in the cpu-vulnerability-directory'\n  desc 'Check for known cpu vulnerabilities described here: https://www.kernel.org/doc/html/v5.6/admin-guide/hw-vuln/index.html'\n  only_if { !container_execution }\n\n  if file(cpuvulndir).exist?\n    describe file(cpuvulndir) do\n      it { should be_directory }\n    end\n\n    loaded_files = command(\"find #{cpuvulndir} -type f -maxdepth 1\").stdout.split(/\\n/).map(&:strip).find_all { |vulnfiles| !vulnfiles.empty? }\n\n    loaded_files.each do |vulnfile|\n      describe file(vulnfile) do\n        its(:content) { should_not match 'vulnerable' }\n        its(:content) { should_not match 'Vulnerable' }\n      end\n    end\n  end\nend\n","source_location":{"line":278,"ref":"linux-baseline/controls/os_spec.rb"},"waiver_data":{},"results":[{"status":"passed","code_desc":"File /sys/devices/system/cpu/vulnerabilities/ is expected to be directory","run_time":0.04377488,"start_time":"2022-05-11T09:57:18+00:00","resource_class":"file","resource_params":"[\"/sys/devices/system/cpu/vulnerabilities/\"]","resource_id":""},{"status":"passed","code_desc":"File /sys/devices/system/cpu/vulnerabilities/spectre_v2 content is expected not to match \"vulnerable\"","run_time":0.005635536,"start_time":"2022-05-11T09:57:18+00:00","resource_class":"file","resource_params":"[\"/sys/devices/system/cpu/vulnerabilities/spectre_v2\"]","resource_id":""},{"status":"passed","code_desc":"File /sys/devices/system/cpu/vulnerabilities/spectre_v2 content is expected not to match \"Vulnerable\"","run_time":0.000274401,"start_time":"2022-05-11T09:57:18+00:00","resource_class":"file","resource_params":"[\"/sys/devices/system/cpu/vulnerabilities/spectre_v2\"]","resource_id":""},{"status":"passed","code_desc":"File /sys/devices/system/cpu/vulnerabilities/itlb_multihit content is expected not to match \"vulnerable\"","run_time":0.005087833,"start_time":"2022-05-11T09:57:18+00:00","resource_class":"file","resource_params":"[\"/sys/devices/system/cpu/vulnerabilities/itlb_multihit\"]","resource_id":""},{"status":"passed","code_desc":"File /sys/devices/system/cpu/vulnerabilities/itlb_multihit content is expected not to match \"Vulnerable\"","run_time":0.000150101,"start_time":"2022-05-11T09:57:18+00:00","resource_class":"file","resource_params":"[\"/sys/devices/system/cpu/vulnerabilities/itlb_multihit\"]","resource_id":""},{"status":"passed","code_desc":"File /sys/devices/system/cpu/vulnerabilities/mds content is expected not to match \"vulnerable\"","run_time":0.00458623,"start_time":"2022-05-11T09:57:18+00:00","resource_class":"file","resource_params":"[\"/sys/devices/system/cpu/vulnerabilities/mds\"]","resource_id":""},{"status":"passed","code_desc":"File /sys/devices/system/cpu/vulnerabilities/mds content is expected not to match \"Vulnerable\"","run_time":0.000188601,"start_time":"2022-05-11T09:57:18+00:00","resource_class":"file","resource_params":"[\"/sys/devices/system/cpu/vulnerabilities/mds\"]","resource_id":""},{"status":"failed","code_desc":"File /sys/devices/system/cpu/vulnerabilities/l1tf content is expected not to match \"vulnerable\"","run_time":0.046023395,"start_time":"2022-05-11T09:57:18+00:00","message":"expected \"Mitigation: PTE Inversion; VMX: conditional cache flushes, SMT vulnerable\\n\" not to match \"vulnerable\"\nDiff:\n@@ -1,2 +1,2 @@\n-vulnerable\n+Mitigation: PTE Inversion; VMX: conditional cache flushes, SMT vulnerable\n","resource_class":"file","resource_params":"[\"/sys/devices/system/cpu/vulnerabilities/l1tf\"]","resource_id":""},{"status":"passed","code_desc":"File /sys/devices/system/cpu/vulnerabilities/l1tf content is expected not to match \"Vulnerable\"","run_time":0.000159701,"start_time":"2022-05-11T09:57:18+00:00","resource_class":"file","resource_params":"[\"/sys/devices/system/cpu/vulnerabilities/l1tf\"]","resource_id":""},{"status":"passed","code_desc":"File /sys/devices/system/cpu/vulnerabilities/spec_store_bypass content is expected not to match \"vulnerable\"","run_time":0.006001939,"start_time":"2022-05-11T09:57:18+00:00","resource_class":"file","resource_params":"[\"/sys/devices/system/cpu/vulnerabilities/spec_store_bypass\"]","resource_id":""},{"status":"failed","code_desc":"File /sys/devices/system/cpu/vulnerabilities/spec_store_bypass content is expected not to match \"Vulnerable\"","run_time":0.000378803,"start_time":"2022-05-11T09:57:18+00:00","message":"expected \"Vulnerable\\n\" not to match \"Vulnerable\"","resource_class":"file","resource_params":"[\"/sys/devices/system/cpu/vulnerabilities/spec_store_bypass\"]","resource_id":""},{"status":"passed","code_desc":"File /sys/devices/system/cpu/vulnerabilities/tsx_async_abort content is expected not to match \"vulnerable\"","run_time":0.00470903,"start_time":"2022-05-11T09:57:18+00:00","resource_class":"file","resource_params":"[\"/sys/devices/system/cpu/vulnerabilities/tsx_async_abort\"]","resource_id":""},{"status":"passed","code_desc":"File /sys/devices/system/cpu/vulnerabilities/tsx_async_abort content is expected not to match \"Vulnerable\"","run_time":0.0001186,"start_time":"2022-05-11T09:57:18+00:00","resource_class":"file","resource_params":"[\"/sys/devices/system/cpu/vulnerabilities/tsx_async_abort\"]","resource_id":""},{"status":"passed","code_desc":"File /sys/devices/system/cpu/vulnerabilities/spectre_v1 content is expected not to match \"vulnerable\"","run_time":0.00462693,"start_time":"2022-05-11T09:57:18+00:00","resource_class":"file","resource_params":"[\"/sys/devices/system/cpu/vulnerabilities/spectre_v1\"]","resource_id":""},{"status":"passed","code_desc":"File /sys/devices/system/cpu/vulnerabilities/spectre_v1 content is expected not to match \"Vulnerable\"","run_time":0.000119401,"start_time":"2022-05-11T09:57:18+00:00","resource_class":"file","resource_params":"[\"/sys/devices/system/cpu/vulnerabilities/spectre_v1\"]","resource_id":""},{"status":"passed","code_desc":"File /sys/devices/system/cpu/vulnerabilities/srbds content is expected not to match \"vulnerable\"","run_time":0.004383028,"start_time":"2022-05-11T09:57:18+00:00","resource_class":"file","resource_params":"[\"/sys/devices/system/cpu/vulnerabilities/srbds\"]","resource_id":""},{"status":"passed","code_desc":"File /sys/devices/system/cpu/vulnerabilities/srbds content is expected not to match \"Vulnerable\"","run_time":0.000114301,"start_time":"2022-05-11T09:57:18+00:00","resource_class":"file","resource_params":"[\"/sys/devices/system/cpu/vulnerabilities/srbds\"]","resource_id":""},{"status":"passed","code_desc":"File /sys/devices/system/cpu/vulnerabilities/meltdown content is expected not to match \"vulnerable\"","run_time":0.049625118,"start_time":"2022-05-11T09:57:18+00:00","resource_class":"file","resource_params":"[\"/sys/devices/system/cpu/vulnerabilities/meltdown\"]","resource_id":""},{"status":"passed","code_desc":"File /sys/devices/system/cpu/vulnerabilities/meltdown content is expected not to match \"Vulnerable\"","run_time":0.000167501,"start_time":"2022-05-11T09:57:18+00:00","resource_class":"file","resource_params":"[\"/sys/devices/system/cpu/vulnerabilities/meltdown\"]","resource_id":""}]},{"id":"os-13","title":"Protect cron directories and files","desc":"The cron directories and files should belong to root.","descriptions":[{"label":"default","data":"The cron directories and files should belong to root."}],"impact":1.0,"refs":[],"tags":{},"code":"control 'os-13' do\n  impact 1.0\n  title 'Protect cron directories and files'\n  desc 'The cron directories and files should belong to root.'\n\n  cron_files = ['/etc/crontab', '/etc/cron.hourly', '/etc/cron.daily', '/etc/cron.weekly', '/etc/cron.monthly', '/etc/cron.d']\n\n  cron_files.each do |cron_file|\n    next unless file(cron_file).exist?\n\n    describe file(cron_file) do\n      it { should be_owned_by 'root' }\n      it { should_not be_writable.by('group') }\n      it { should_not be_writable.by('other') }\n      it { should_not be_readable.by('group') }\n      it { should_not be_readable.by('other') }\n    end\n  end\nend\n","source_location":{"line":300,"ref":"linux-baseline/controls/os_spec.rb"},"waiver_data":{},"results":[{"status":"passed","code_desc":"File /etc/crontab is expected to be owned by \"root\"","run_time":0.009850263,"start_time":"2022-05-11T09:57:18+00:00","resource_class":"file","resource_params":"[\"/etc/crontab\"]","resource_id":""},{"status":"passed","code_desc":"File /etc/crontab is expected not to be writable by group","run_time":0.000200401,"start_time":"2022-05-11T09:57:18+00:00","resource_class":"file","resource_params":"[\"/etc/crontab\"]","resource_id":""},{"status":"passed","code_desc":"File /etc/crontab is expected not to be writable by other","run_time":0.000100701,"start_time":"2022-05-11T09:57:18+00:00","resource_class":"file","resource_params":"[\"/etc/crontab\"]","resource_id":""},{"status":"failed","code_desc":"File /etc/crontab is expected not to be readable by group","run_time":0.000162101,"start_time":"2022-05-11T09:57:18+00:00","message":"expected File /etc/crontab not to be readable by group","resource_class":"file","resource_params":"[\"/etc/crontab\"]","resource_id":""},{"status":"failed","code_desc":"File /etc/crontab is expected not to be readable by other","run_time":0.000199301,"start_time":"2022-05-11T09:57:18+00:00","message":"expected File /etc/crontab not to be readable by other","resource_class":"file","resource_params":"[\"/etc/crontab\"]","resource_id":""},{"status":"passed","code_desc":"File /etc/cron.hourly is expected to be owned by \"root\"","run_time":0.009734262,"start_time":"2022-05-11T09:57:18+00:00","resource_class":"file","resource_params":"[\"/etc/cron.hourly\"]","resource_id":""},{"status":"passed","code_desc":"File /etc/cron.hourly is expected not to be writable by group","run_time":0.000158701,"start_time":"2022-05-11T09:57:18+00:00","resource_class":"file","resource_params":"[\"/etc/cron.hourly\"]","resource_id":""},{"status":"passed","code_desc":"File /etc/cron.hourly is expected not to be writable by other","run_time":0.0001241,"start_time":"2022-05-11T09:57:18+00:00","resource_class":"file","resource_params":"[\"/etc/cron.hourly\"]","resource_id":""},{"status":"failed","code_desc":"File /etc/cron.hourly is expected not to be readable by group","run_time":0.000144801,"start_time":"2022-05-11T09:57:18+00:00","message":"expected File /etc/cron.hourly not to be readable by group","resource_class":"file","resource_params":"[\"/etc/cron.hourly\"]","resource_id":""},{"status":"failed","code_desc":"File /etc/cron.hourly is expected not to be readable by other","run_time":0.000180101,"start_time":"2022-05-11T09:57:18+00:00","message":"expected File /etc/cron.hourly not to be readable by other","resource_class":"file","resource_params":"[\"/etc/cron.hourly\"]","resource_id":""},{"status":"passed","code_desc":"File /etc/cron.daily is expected to be owned by \"root\"","run_time":0.046494698,"start_time":"2022-05-11T09:57:18+00:00","resource_class":"file","resource_params":"[\"/etc/cron.daily\"]","resource_id":""},{"status":"passed","code_desc":"File /etc/cron.daily is expected not to be writable by group","run_time":0.000249802,"start_time":"2022-05-11T09:57:19+00:00","resource_class":"file","resource_params":"[\"/etc/cron.daily\"]","resource_id":""},{"status":"passed","code_desc":"File /etc/cron.daily is expected not to be writable by other","run_time":9.7401e-05,"start_time":"2022-05-11T09:57:19+00:00","resource_class":"file","resource_params":"[\"/etc/cron.daily\"]","resource_id":""},{"status":"failed","code_desc":"File /etc/cron.daily is expected not to be readable by group","run_time":0.000196301,"start_time":"2022-05-11T09:57:19+00:00","message":"expected File /etc/cron.daily not to be readable by group","resource_class":"file","resource_params":"[\"/etc/cron.daily\"]","resource_id":""},{"status":"failed","code_desc":"File /etc/cron.daily is expected not to be readable by other","run_time":0.000118,"start_time":"2022-05-11T09:57:19+00:00","message":"expected File /etc/cron.daily not to be readable by other","resource_class":"file","resource_params":"[\"/etc/cron.daily\"]","resource_id":""},{"status":"passed","code_desc":"File /etc/cron.weekly is expected to be owned by \"root\"","run_time":0.009704563,"start_time":"2022-05-11T09:57:19+00:00","resource_class":"file","resource_params":"[\"/etc/cron.weekly\"]","resource_id":""},{"status":"passed","code_desc":"File /etc/cron.weekly is expected not to be writable by group","run_time":0.000168401,"start_time":"2022-05-11T09:57:19+00:00","resource_class":"file","resource_params":"[\"/etc/cron.weekly\"]","resource_id":""},{"status":"passed","code_desc":"File /etc/cron.weekly is expected not to be writable by other","run_time":9.5301e-05,"start_time":"2022-05-11T09:57:19+00:00","resource_class":"file","resource_params":"[\"/etc/cron.weekly\"]","resource_id":""},{"status":"failed","code_desc":"File /etc/cron.weekly is expected not to be readable by group","run_time":0.000163301,"start_time":"2022-05-11T09:57:19+00:00","message":"expected File /etc/cron.weekly not to be readable by group","resource_class":"file","resource_params":"[\"/etc/cron.weekly\"]","resource_id":""},{"status":"failed","code_desc":"File /etc/cron.weekly is expected not to be readable by other","run_time":0.000113701,"start_time":"2022-05-11T09:57:19+00:00","message":"expected File /etc/cron.weekly not to be readable by other","resource_class":"file","resource_params":"[\"/etc/cron.weekly\"]","resource_id":""},{"status":"passed","code_desc":"File /etc/cron.monthly is expected to be owned by \"root\"","run_time":0.009540961,"start_time":"2022-05-11T09:57:19+00:00","resource_class":"file","resource_params":"[\"/etc/cron.monthly\"]","resource_id":""},{"status":"passed","code_desc":"File /etc/cron.monthly is expected not to be writable by group","run_time":0.000159401,"start_time":"2022-05-11T09:57:19+00:00","resource_class":"file","resource_params":"[\"/etc/cron.monthly\"]","resource_id":""},{"status":"passed","code_desc":"File /etc/cron.monthly is expected not to be writable by other","run_time":0.000108201,"start_time":"2022-05-11T09:57:19+00:00","resource_class":"file","resource_params":"[\"/etc/cron.monthly\"]","resource_id":""},{"status":"failed","code_desc":"File /etc/cron.monthly is expected not to be readable by group","run_time":0.000169601,"start_time":"2022-05-11T09:57:19+00:00","message":"expected File /etc/cron.monthly not to be readable by group","resource_class":"file","resource_params":"[\"/etc/cron.monthly\"]","resource_id":""},{"status":"failed","code_desc":"File /etc/cron.monthly is expected not to be readable by other","run_time":0.000129101,"start_time":"2022-05-11T09:57:19+00:00","message":"expected File /etc/cron.monthly not to be readable by other","resource_class":"file","resource_params":"[\"/etc/cron.monthly\"]","resource_id":""},{"status":"passed","code_desc":"File /etc/cron.d is expected to be owned by \"root\"","run_time":0.046308297,"start_time":"2022-05-11T09:57:19+00:00","resource_class":"file","resource_params":"[\"/etc/cron.d\"]","resource_id":""},{"status":"passed","code_desc":"File /etc/cron.d is expected not to be writable by group","run_time":0.000265301,"start_time":"2022-05-11T09:57:19+00:00","resource_class":"file","resource_params":"[\"/etc/cron.d\"]","resource_id":""},{"status":"passed","code_desc":"File /etc/cron.d is expected not to be writable by other","run_time":0.000216202,"start_time":"2022-05-11T09:57:19+00:00","resource_class":"file","resource_params":"[\"/etc/cron.d\"]","resource_id":""},{"status":"failed","code_desc":"File /etc/cron.d is expected not to be readable by group","run_time":0.000218902,"start_time":"2022-05-11T09:57:19+00:00","message":"expected File /etc/cron.d not to be readable by group","resource_class":"file","resource_params":"[\"/etc/cron.d\"]","resource_id":""},{"status":"failed","code_desc":"File /etc/cron.d is expected not to be readable by other","run_time":0.000160401,"start_time":"2022-05-11T09:57:19+00:00","message":"expected File /etc/cron.d not to be readable by other","resource_class":"file","resource_params":"[\"/etc/cron.d\"]","resource_id":""}]},{"id":"os-14","title":"Check mountpoints for noexec mount options","desc":"Use the noexec mount options to limit attack vectors via mount points","descriptions":[{"label":"default","data":"Use the noexec mount options to limit attack vectors via mount points"}],"impact":1.0,"refs":[],"tags":{},"code":"control 'os-14' do\n  impact 1.0\n  title 'Check mountpoints for noexec mount options'\n  desc 'Use the noexec mount options to limit attack vectors via mount points'\n\n  mount_exec_blocklist.each do |mnt_point|\n    next unless mount(mnt_point).mounted?\n\n    describe mount(mnt_point) do\n      its('options') { should include('noexec') }\n    end\n  end\nend\n","source_location":{"line":320,"ref":"linux-baseline/controls/os_spec.rb"},"waiver_data":{},"results":[{"status":"failed","code_desc":"Mount /dev options is expected to include \"noexec\"","run_time":0.000417902,"start_time":"2022-05-11T09:57:19+00:00","message":"expected [\"rw\", \"relatime\", \"size=4068768k\", \"nr_inodes=1017192\", \"mode=755\", \"inode64\"] to include \"noexec\"","resource_class":"mount","resource_params":"[\"/dev\"]","resource_id":""},{"status":"failed","code_desc":"Mount /dev/shm options is expected to include \"noexec\"","run_time":0.000293601,"start_time":"2022-05-11T09:57:19+00:00","message":"expected [\"rw\", \"nosuid\", \"nodev\", \"inode64\"] to include \"noexec\"","resource_class":"mount","resource_params":"[\"/dev/shm\"]","resource_id":""}]},{"id":"os-15","title":"Check mountpoints for nosuid mount options","desc":"Use the nosuid mount options to limit attack vectors via mount points","descriptions":[{"label":"default","data":"Use the nosuid mount options to limit attack vectors via mount points"}],"impact":1.0,"refs":[],"tags":{},"code":"control 'os-15' do\n  impact 1.0\n  title 'Check mountpoints for nosuid mount options'\n  desc 'Use the nosuid mount options to limit attack vectors via mount points'\n\n  mount_suid_blocklist.each do |mnt_point|\n    next unless mount(mnt_point).mounted?\n\n    describe mount(mnt_point) do\n      its('options') { should include('nosuid') }\n    end\n  end\nend\n","source_location":{"line":334,"ref":"linux-baseline/controls/os_spec.rb"},"waiver_data":{},"results":[{"status":"failed","code_desc":"Mount /dev options is expected to include \"nosuid\"","run_time":0.000297202,"start_time":"2022-05-11T09:57:19+00:00","message":"expected [\"rw\", \"relatime\", \"size=4068768k\", \"nr_inodes=1017192\", \"mode=755\", \"inode64\"] to include \"nosuid\"","resource_class":"mount","resource_params":"[\"/dev\"]","resource_id":""},{"status":"passed","code_desc":"Mount /dev/shm options is expected to include \"nosuid\"","run_time":0.000118201,"start_time":"2022-05-11T09:57:19+00:00","resource_class":"mount","resource_params":"[\"/dev/shm\"]","resource_id":""},{"status":"passed","code_desc":"Mount /run options is expected to include \"nosuid\"","run_time":0.000108501,"start_time":"2022-05-11T09:57:19+00:00","resource_class":"mount","resource_params":"[\"/run\"]","resource_id":""}]},{"id":"os-16","title":"Check mountpoints for nodev mount options","desc":"Use the nodev mount options to limit attack vectors via mount points","descriptions":[{"label":"default","data":"Use the nodev mount options to limit attack vectors via mount points"}],"impact":1.0,"refs":[],"tags":{},"code":"control 'os-16' do\n  impact 1.0\n  title 'Check mountpoints for nodev mount options'\n  desc 'Use the nodev mount options to limit attack vectors via mount points'\n\n  mount_dev_blocklist.each do |mnt_point|\n    next unless mount(mnt_point).mounted?\n\n    describe mount(mnt_point) do\n      its('options') { should include('nodev') }\n    end\n  end\nend\n","source_location":{"line":348,"ref":"linux-baseline/controls/os_spec.rb"},"waiver_data":{},"results":[{"status":"passed","code_desc":"Mount /dev/shm options is expected to include \"nodev\"","run_time":0.000109501,"start_time":"2022-05-11T09:57:19+00:00","resource_class":"mount","resource_params":"[\"/dev/shm\"]","resource_id":""},{"status":"passed","code_desc":"Mount /run options is expected to include \"nodev\"","run_time":0.000108001,"start_time":"2022-05-11T09:57:19+00:00","resource_class":"mount","resource_params":"[\"/run\"]","resource_id":""}]},{"id":"package-01","title":"Do not run deprecated inetd or xinetd","desc":"http://www.nsa.gov/ia/_files/os/redhat/rhel5-guide-i731.pdf, Chapter 3.2.1","descriptions":[{"label":"default","data":"http://www.nsa.gov/ia/_files/os/redhat/rhel5-guide-i731.pdf, Chapter 3.2.1"}],"impact":1.0,"refs":[],"tags":{},"code":"control 'package-01' do\n  impact 1.0\n  title 'Do not run deprecated inetd or xinetd'\n  desc 'http://www.nsa.gov/ia/_files/os/redhat/rhel5-guide-i731.pdf, Chapter 3.2.1'\n  describe package('inetd') do\n    it { should_not be_installed }\n  end\n  describe package('xinetd') do\n    it { should_not be_installed }\n  end\nend\n","source_location":{"line":28,"ref":"linux-baseline/controls/package_spec.rb"},"waiver_data":{},"results":[{"status":"passed","code_desc":"System Package inetd is expected not to be installed","run_time":0.014541093,"start_time":"2022-05-11T09:57:17+00:00","resource_class":"package","resource_params":"[\"inetd\"]","resource_id":""},{"status":"passed","code_desc":"System Package xinetd is expected not to be installed","run_time":0.058730877,"start_time":"2022-05-11T09:57:17+00:00","resource_class":"package","resource_params":"[\"xinetd\"]","resource_id":""}]},{"id":"package-02","title":"Do not install Telnet server","desc":"Telnet protocol uses unencrypted communication, that means the password and other sensitive data are unencrypted. http://www.nsa.gov/ia/_files/os/redhat/rhel5-guide-i731.pdf, Chapter 3.2.2","descriptions":[{"label":"default","data":"Telnet protocol uses unencrypted communication, that means the password and other sensitive data are unencrypted. http://www.nsa.gov/ia/_files/os/redhat/rhel5-guide-i731.pdf, Chapter 3.2.2"}],"impact":1.0,"refs":[],"tags":{},"code":"control 'package-02' do\n  impact 1.0\n  title 'Do not install Telnet server'\n  desc 'Telnet protocol uses unencrypted communication, that means the password and other sensitive data are unencrypted. http://www.nsa.gov/ia/_files/os/redhat/rhel5-guide-i731.pdf, Chapter 3.2.2'\n  describe package('telnetd') do\n    it { should_not be_installed }\n  end\nend\n","source_location":{"line":40,"ref":"linux-baseline/controls/package_spec.rb"},"waiver_data":{},"results":[{"status":"passed","code_desc":"System Package telnetd is expected not to be installed","run_time":0.013624587,"start_time":"2022-05-11T09:57:17+00:00","resource_class":"package","resource_params":"[\"telnetd\"]","resource_id":""}]},{"id":"package-03","title":"Do not install rsh server","desc":"The r-commands suffers same problem as telnet. http://www.nsa.gov/ia/_files/os/redhat/rhel5-guide-i731.pdf, Chapter 3.2.3","descriptions":[{"label":"default","data":"The r-commands suffers same problem as telnet. http://www.nsa.gov/ia/_files/os/redhat/rhel5-guide-i731.pdf, Chapter 3.2.3"}],"impact":1.0,"refs":[],"tags":{},"code":"control 'package-03' do\n  impact 1.0\n  title 'Do not install rsh server'\n  desc 'The r-commands suffers same problem as telnet. http://www.nsa.gov/ia/_files/os/redhat/rhel5-guide-i731.pdf, Chapter 3.2.3'\n  describe package('rsh-server') do\n    it { should_not be_installed }\n  end\nend\n","source_location":{"line":49,"ref":"linux-baseline/controls/package_spec.rb"},"waiver_data":{},"results":[{"status":"passed","code_desc":"System Package rsh-server is expected not to be installed","run_time":0.015410799,"start_time":"2022-05-11T09:57:17+00:00","resource_class":"package","resource_params":"[\"rsh-server\"]","resource_id":""}]},{"id":"package-05","title":"Do not install ypserv server (NIS)","desc":"Network Information Service (NIS) has some security design weaknesses like inadequate protection of important authentication information. http://www.nsa.gov/ia/_files/os/redhat/rhel5-guide-i731.pdf, Chapter 3.2.4","descriptions":[{"label":"default","data":"Network Information Service (NIS) has some security design weaknesses like inadequate protection of important authentication information. http://www.nsa.gov/ia/_files/os/redhat/rhel5-guide-i731.pdf, Chapter 3.2.4"}],"impact":1.0,"refs":[],"tags":{},"code":"control 'package-05' do\n  impact 1.0\n  title 'Do not install ypserv server (NIS)'\n  desc 'Network Information Service (NIS) has some security design weaknesses like inadequate protection of important authentication information. http://www.nsa.gov/ia/_files/os/redhat/rhel5-guide-i731.pdf, Chapter 3.2.4'\n  describe package('ypserv') do\n    it { should_not be_installed }\n  end\nend\n","source_location":{"line":60,"ref":"linux-baseline/controls/package_spec.rb"},"waiver_data":{},"results":[{"status":"passed","code_desc":"System Package ypserv is expected not to be installed","run_time":0.013748788,"start_time":"2022-05-11T09:57:17+00:00","resource_class":"package","resource_params":"[\"ypserv\"]","resource_id":""}]},{"id":"package-06","title":"Do not install tftp server","desc":"tftp-server provides little security http://www.nsa.gov/ia/_files/os/redhat/rhel5-guide-i731.pdf, Chapter 3.2.5","descriptions":[{"label":"default","data":"tftp-server provides little security http://www.nsa.gov/ia/_files/os/redhat/rhel5-guide-i731.pdf, Chapter 3.2.5"}],"impact":1.0,"refs":[],"tags":{},"code":"control 'package-06' do\n  impact 1.0\n  title 'Do not install tftp server'\n  desc 'tftp-server provides little security http://www.nsa.gov/ia/_files/os/redhat/rhel5-guide-i731.pdf, Chapter 3.2.5'\n  describe package('tftp-server') do\n    it { should_not be_installed }\n  end\nend\n","source_location":{"line":69,"ref":"linux-baseline/controls/package_spec.rb"},"waiver_data":{},"results":[{"status":"passed","code_desc":"System Package tftp-server is expected not to be installed","run_time":0.056538163,"start_time":"2022-05-11T09:57:17+00:00","resource_class":"package","resource_params":"[\"tftp-server\"]","resource_id":""}]},{"id":"package-08","title":"Install auditd","desc":"auditd provides extended logging capabilities on recent distributions","descriptions":[{"label":"default","data":"auditd provides extended logging capabilities on recent distributions"}],"impact":1.0,"refs":[],"tags":{},"code":"control 'package-08' do\n  impact 1.0\n  title 'Install auditd'\n  desc 'auditd provides extended logging capabilities on recent distributions'\n  only_if { !container_execution }\n  audit_pkg = os.redhat? || os.suse? || os.name == 'amazon' || os.name == 'fedora' || os.name == 'arch' ? 'audit' : 'auditd'\n  describe package(audit_pkg) do\n    it { should be_installed }\n  end\n  describe auditd_conf do\n    its('log_file') { should cmp '/var/log/audit/audit.log' }\n    its('log_format') { should cmp 'raw' }\n    its('flush') { should match(/^incremental|INCREMENTAL|incremental_async|INCREMENTAL_ASYNC$/) }\n    its('max_log_file_action') { should cmp 'keep_logs' }\n    its('space_left') { should cmp 75 }\n    its('action_mail_acct') { should cmp 'root' }\n    its('space_left_action') { should cmp 'SYSLOG' }\n    its('admin_space_left') { should cmp 50 }\n    its('admin_space_left_action') { should cmp 'SUSPEND' }\n    its('disk_full_action') { should cmp 'SUSPEND' }\n    its('disk_error_action') { should cmp 'SUSPEND' }\n  end\nend\n","source_location":{"line":78,"ref":"linux-baseline/controls/package_spec.rb"},"waiver_data":{},"results":[{"status":"failed","code_desc":"System Package auditd is expected to be installed","run_time":0.029366788,"start_time":"2022-05-11T09:57:18+00:00","message":"expected that `System Package auditd` is installed","resource_class":"package","resource_params":"[\"auditd\"]","resource_id":""},{"status":"skipped","code_desc":"Audit Daemon Config","run_time":1.16e-05,"start_time":"2022-05-11T09:57:18+00:00","resource":"Audit Daemon Config","skip_message":"Can't find file: /etc/audit/auditd.conf","resource_class":"auditd_conf","resource_params":"[]","resource_id":""}]},{"id":"package-09","title":"CIS: Additional process hardening","desc":"1.5.4 Ensure prelink is disabled","descriptions":[{"label":"default","data":"1.5.4 Ensure prelink is disabled"}],"impact":1.0,"refs":[],"tags":{},"code":"control 'package-09' do\n  impact 1.0\n  title 'CIS: Additional process hardening'\n  desc '1.5.4 Ensure prelink is disabled'\n  describe package('prelink') do\n    it { should_not be_installed }\n  end\nend\n","source_location":{"line":102,"ref":"linux-baseline/controls/package_spec.rb"},"waiver_data":{},"results":[{"status":"passed","code_desc":"System Package prelink is expected not to be installed","run_time":0.014192591,"start_time":"2022-05-11T09:57:18+00:00","resource_class":"package","resource_params":"[\"prelink\"]","resource_id":""}]},{"id":"sysctl-01","title":"IPv4 Forwarding","desc":"If you're not intending for your system to forward traffic between interfaces, or if you only have a single interface, the forwarding function must be disable.","descriptions":[{"label":"default","data":"If you're not intending for your system to forward traffic between interfaces, or if you only have a single interface, the forwarding function must be disable."}],"impact":1.0,"refs":[],"tags":{},"code":"control 'sysctl-01' do\n  impact 1.0\n  title 'IPv4 Forwarding'\n  desc \"If you're not intending for your system to forward traffic between interfaces, or if you only have a single interface, the forwarding function must be disable.\"\n  only_if { sysctl_forwarding == false && !container_execution }\n  describe kernel_parameter('net.ipv4.ip_forward') do\n    its(:value) { should eq 0 }\n  end\n  describe kernel_parameter('net.ipv4.conf.all.forwarding') do\n    its(:value) { should eq 0 }\n  end\nend\n","source_location":{"line":30,"ref":"linux-baseline/controls/sysctl_spec.rb"},"waiver_data":{},"results":[{"status":"passed","code_desc":"Kernel Parameter net.ipv4.ip_forward value is expected to eq 0","run_time":0.005020132,"start_time":"2022-05-11T09:57:19+00:00","resource_class":"kernel_parameter","resource_params":"[\"net.ipv4.ip_forward\"]","resource_id":""},{"status":"passed","code_desc":"Kernel Parameter net.ipv4.conf.all.forwarding value is expected to eq 0","run_time":0.045490192,"start_time":"2022-05-11T09:57:19+00:00","resource_class":"kernel_parameter","resource_params":"[\"net.ipv4.conf.all.forwarding\"]","resource_id":""}]},{"id":"sysctl-02","title":"Reverse path filtering","desc":"The rp_filter can reject incoming packets if their source address doesn't match the network interface that they're arriving on, which helps to prevent IP spoofing.","descriptions":[{"label":"default","data":"The rp_filter can reject incoming packets if their source address doesn't match the network interface that they're arriving on, which helps to prevent IP spoofing."}],"impact":1.0,"refs":[],"tags":{},"code":"control 'sysctl-02' do\n  impact 1.0\n  title 'Reverse path filtering'\n  desc \"The rp_filter can reject incoming packets if their source address doesn't match the network interface that they're arriving on, which helps to prevent IP spoofing.\"\n  only_if { !container_execution }\n  describe kernel_parameter('net.ipv4.conf.all.rp_filter') do\n    its(:value) { should eq 1 }\n  end\n  describe kernel_parameter('net.ipv4.conf.default.rp_filter') do\n    its(:value) { should eq 1 }\n  end\nend\n","source_location":{"line":43,"ref":"linux-baseline/controls/sysctl_spec.rb"},"waiver_data":{},"results":[{"status":"failed","code_desc":"Kernel Parameter net.ipv4.conf.all.rp_filter value is expected to eq 1","run_time":0.004744031,"start_time":"2022-05-11T09:57:19+00:00","message":"\nexpected: 1\n     got: 2\n\n(compared using ==)\n","resource_class":"kernel_parameter","resource_params":"[\"net.ipv4.conf.all.rp_filter\"]","resource_id":""},{"status":"failed","code_desc":"Kernel Parameter net.ipv4.conf.default.rp_filter value is expected to eq 1","run_time":0.004882732,"start_time":"2022-05-11T09:57:19+00:00","message":"\nexpected: 1\n     got: 2\n\n(compared using ==)\n","resource_class":"kernel_parameter","resource_params":"[\"net.ipv4.conf.default.rp_filter\"]","resource_id":""}]},{"id":"sysctl-03","title":"ICMP ignore bogus error responses","desc":"Sometimes routers send out invalid responses to broadcast frames. This is a violation of RFC 1122 and the kernel will logged this. To avoid filling up your logfile with unnecessary stuff, you can tell the kernel not to issue these warnings","descriptions":[{"label":"default","data":"Sometimes routers send out invalid responses to broadcast frames. This is a violation of RFC 1122 and the kernel will logged this. To avoid filling up your logfile with unnecessary stuff, you can tell the kernel not to issue these warnings"}],"impact":1.0,"refs":[],"tags":{},"code":"control 'sysctl-03' do\n  impact 1.0\n  title 'ICMP ignore bogus error responses'\n  desc 'Sometimes routers send out invalid responses to broadcast frames. This is a violation of RFC 1122 and the kernel will logged this. To avoid filling up your logfile with unnecessary stuff, you can tell the kernel not to issue these warnings'\n  only_if { !container_execution }\n  describe kernel_parameter('net.ipv4.icmp_ignore_bogus_error_responses') do\n    its(:value) { should eq 1 }\n  end\nend\n","source_location":{"line":56,"ref":"linux-baseline/controls/sysctl_spec.rb"},"waiver_data":{},"results":[{"status":"passed","code_desc":"Kernel Parameter net.ipv4.icmp_ignore_bogus_error_responses value is expected to eq 1","run_time":0.004578129,"start_time":"2022-05-11T09:57:19+00:00","resource_class":"kernel_parameter","resource_params":"[\"net.ipv4.icmp_ignore_bogus_error_responses\"]","resource_id":""}]},{"id":"sysctl-04","title":"ICMP echo ignore broadcasts","desc":"Blocking ICMP ECHO requests to broadcast addresses","descriptions":[{"label":"default","data":"Blocking ICMP ECHO requests to broadcast addresses"}],"impact":1.0,"refs":[],"tags":{},"code":"control 'sysctl-04' do\n  impact 1.0\n  title 'ICMP echo ignore broadcasts'\n  desc 'Blocking ICMP ECHO requests to broadcast addresses'\n  only_if { !container_execution }\n  describe kernel_parameter('net.ipv4.icmp_echo_ignore_broadcasts') do\n    its(:value) { should eq 1 }\n  end\nend\n","source_location":{"line":66,"ref":"linux-baseline/controls/sysctl_spec.rb"},"waiver_data":{},"results":[{"status":"passed","code_desc":"Kernel Parameter net.ipv4.icmp_echo_ignore_broadcasts value is expected to eq 1","run_time":0.004288228,"start_time":"2022-05-11T09:57:19+00:00","resource_class":"kernel_parameter","resource_params":"[\"net.ipv4.icmp_echo_ignore_broadcasts\"]","resource_id":""}]},{"id":"sysctl-05","title":"ICMP ratelimit","desc":"icmp_ratelimit defines how many packets that match the icmp_ratemask per second","descriptions":[{"label":"default","data":"icmp_ratelimit defines how many packets that match the icmp_ratemask per second"}],"impact":1.0,"refs":[],"tags":{},"code":"control 'sysctl-05' do\n  impact 1.0\n  title 'ICMP ratelimit'\n  desc 'icmp_ratelimit defines how many packets that match the icmp_ratemask per second'\n  only_if { !container_execution }\n  describe kernel_parameter('net.ipv4.icmp_ratelimit') do\n    its(:value) { should eq 100 }\n  end\nend\n","source_location":{"line":76,"ref":"linux-baseline/controls/sysctl_spec.rb"},"waiver_data":{},"results":[{"status":"failed","code_desc":"Kernel Parameter net.ipv4.icmp_ratelimit value is expected to eq 100","run_time":0.004460929,"start_time":"2022-05-11T09:57:19+00:00","message":"\nexpected: 100\n     got: 1000\n\n(compared using ==)\n","resource_class":"kernel_parameter","resource_params":"[\"net.ipv4.icmp_ratelimit\"]","resource_id":""}]},{"id":"sysctl-06","title":"ICMP ratemask","desc":"Ratemask is a logical OR of all ICMP codes to rate limit","descriptions":[{"label":"default","data":"Ratemask is a logical OR of all ICMP codes to rate limit"}],"impact":1.0,"refs":[],"tags":{},"code":"control 'sysctl-06' do\n  impact 1.0\n  title 'ICMP ratemask'\n  desc 'Ratemask is a logical OR of all ICMP codes to rate limit'\n  only_if { !container_execution }\n  describe kernel_parameter('net.ipv4.icmp_ratemask') do\n    its(:value) { should eq 88089 }\n  end\nend\n","source_location":{"line":86,"ref":"linux-baseline/controls/sysctl_spec.rb"},"waiver_data":{},"results":[{"status":"failed","code_desc":"Kernel Parameter net.ipv4.icmp_ratemask value is expected to eq 88089","run_time":0.004342928,"start_time":"2022-05-11T09:57:19+00:00","message":"\nexpected: 88089\n     got: 6168\n\n(compared using ==)\n","resource_class":"kernel_parameter","resource_params":"[\"net.ipv4.icmp_ratemask\"]","resource_id":""}]},{"id":"sysctl-07","title":"TCP timestamps","desc":"It is possible to estimate the current uptime of a Linux system. It's preferable to disable TCP timestamps on your systems.","descriptions":[{"label":"default","data":"It is possible to estimate the current uptime of a Linux system. It's preferable to disable TCP timestamps on your systems."}],"impact":1.0,"refs":[],"tags":{},"code":"control 'sysctl-07' do\n  impact 1.0\n  title 'TCP timestamps'\n  desc \"It is possible to estimate the current uptime of a Linux system. It's preferable to disable TCP timestamps on your systems.\"\n  only_if { !container_execution }\n  describe kernel_parameter('net.ipv4.tcp_timestamps') do\n    its(:value) { should eq 0 }\n  end\nend\n","source_location":{"line":96,"ref":"linux-baseline/controls/sysctl_spec.rb"},"waiver_data":{},"results":[{"status":"failed","code_desc":"Kernel Parameter net.ipv4.tcp_timestamps value is expected to eq 0","run_time":0.004246527,"start_time":"2022-05-11T09:57:19+00:00","message":"\nexpected: 0\n     got: 1\n\n(compared using ==)\n","resource_class":"kernel_parameter","resource_params":"[\"net.ipv4.tcp_timestamps\"]","resource_id":""}]},{"id":"sysctl-08","title":"ARP ignore","desc":"Reply only if the target IP address is local address configured on the incoming interface.","descriptions":[{"label":"default","data":"Reply only if the target IP address is local address configured on the incoming interface."}],"impact":1.0,"refs":[],"tags":{},"code":"control 'sysctl-08' do\n  impact 1.0\n  title 'ARP ignore'\n  desc 'Reply only if the target IP address is local address configured on the incoming interface.'\n  only_if { !container_execution }\n  describe kernel_parameter('net.ipv4.conf.all.arp_ignore') do\n    its(:value) { should cmp(/(1|2)/) }\n  end\nend\n","source_location":{"line":106,"ref":"linux-baseline/controls/sysctl_spec.rb"},"waiver_data":{},"results":[{"status":"failed","code_desc":"Kernel Parameter net.ipv4.conf.all.arp_ignore value is expected to cmp == /(1|2)/","run_time":0.004352928,"start_time":"2022-05-11T09:57:19+00:00","message":"\nexpected: (?-mix:(1|2))\n     got: 0\n\n(compared using `cmp` matcher)\n","resource_class":"kernel_parameter","resource_params":"[\"net.ipv4.conf.all.arp_ignore\"]","resource_id":""}]},{"id":"sysctl-09","title":"ARP announce","desc":"Always use the best local address for this target. In this mode we ignore the source address in the IP packet and try to select local address that we prefer for talks with\tthe target host.","descriptions":[{"label":"default","data":"Always use the best local address for this target. In this mode we ignore the source address in the IP packet and try to select local address that we prefer for talks with\tthe target host."}],"impact":1.0,"refs":[],"tags":{},"code":"control 'sysctl-09' do\n  impact 1.0\n  title 'ARP announce'\n  desc 'Always use the best local address for this target. In this mode we ignore the source address in the IP packet and try to select local address that we prefer for talks with\tthe target host.'\n  only_if { !container_execution }\n  describe kernel_parameter('net.ipv4.conf.all.arp_announce') do\n    its(:value) { should eq 2 }\n  end\nend\n","source_location":{"line":116,"ref":"linux-baseline/controls/sysctl_spec.rb"},"waiver_data":{},"results":[{"status":"failed","code_desc":"Kernel Parameter net.ipv4.conf.all.arp_announce value is expected to eq 2","run_time":0.004262727,"start_time":"2022-05-11T09:57:19+00:00","message":"\nexpected: 2\n     got: 0\n\n(compared using ==)\n","resource_class":"kernel_parameter","resource_params":"[\"net.ipv4.conf.all.arp_announce\"]","resource_id":""}]},{"id":"sysctl-10","title":"TCP RFC1337 Protect Against TCP Time-Wait","desc":"This enables a fix for time-wait assassination hazards in tcp, described in RFC 1337. If enabled, this causes the kernel to drop RST packets for sockets in the time-wait state.","descriptions":[{"label":"default","data":"This enables a fix for time-wait assassination hazards in tcp, described in RFC 1337. If enabled, this causes the kernel to drop RST packets for sockets in the time-wait state."}],"impact":1.0,"refs":[],"tags":{},"code":"control 'sysctl-10' do\n  impact 1.0\n  title 'TCP RFC1337 Protect Against TCP Time-Wait'\n  desc 'This enables a fix for time-wait assassination hazards in tcp, described in RFC 1337. If enabled, this causes the kernel to drop RST packets for sockets in the time-wait state.'\n  only_if { !container_execution }\n  describe kernel_parameter('net.ipv4.tcp_rfc1337') do\n    its(:value) { should eq 1 }\n  end\nend\n","source_location":{"line":126,"ref":"linux-baseline/controls/sysctl_spec.rb"},"waiver_data":{},"results":[{"status":"failed","code_desc":"Kernel Parameter net.ipv4.tcp_rfc1337 value is expected to eq 1","run_time":0.046250697,"start_time":"2022-05-11T09:57:19+00:00","message":"\nexpected: 1\n     got: 0\n\n(compared using ==)\n","resource_class":"kernel_parameter","resource_params":"[\"net.ipv4.tcp_rfc1337\"]","resource_id":""}]},{"id":"sysctl-11","title":"Protection against SYN flood attacks","desc":"A SYN-Attack is a denial of service (DoS) attack that consumes resources on your system forcing you to reboot.","descriptions":[{"label":"default","data":"A SYN-Attack is a denial of service (DoS) attack that consumes resources on your system forcing you to reboot."}],"impact":1.0,"refs":[],"tags":{},"code":"control 'sysctl-11' do\n  impact 1.0\n  title 'Protection against SYN flood attacks'\n  desc 'A SYN-Attack is a denial of service (DoS) attack that consumes resources on your system forcing you to reboot.'\n  only_if { !container_execution }\n  describe kernel_parameter('net.ipv4.tcp_syncookies') do\n    its(:value) { should eq 1 }\n  end\nend\n","source_location":{"line":136,"ref":"linux-baseline/controls/sysctl_spec.rb"},"waiver_data":{},"results":[{"status":"passed","code_desc":"Kernel Parameter net.ipv4.tcp_syncookies value is expected to eq 1","run_time":0.00477053,"start_time":"2022-05-11T09:57:19+00:00","resource_class":"kernel_parameter","resource_params":"[\"net.ipv4.tcp_syncookies\"]","resource_id":""}]},{"id":"sysctl-12","title":"Shared Media IP Architecture","desc":"Send(router) or accept(host) RFC1620 shared media redirects. If it is not set the kernel does not assume that different subnets on this device can communicate directly.","descriptions":[{"label":"default","data":"Send(router) or accept(host) RFC1620 shared media redirects. If it is not set the kernel does not assume that different subnets on this device can communicate directly."}],"impact":1.0,"refs":[],"tags":{},"code":"control 'sysctl-12' do\n  impact 1.0\n  title 'Shared Media IP Architecture'\n  desc 'Send(router) or accept(host) RFC1620 shared media redirects. If it is not set the kernel does not assume that different subnets on this device can communicate directly.'\n  only_if { !container_execution }\n  describe kernel_parameter('net.ipv4.conf.all.shared_media') do\n    its(:value) { should eq 1 }\n  end\n  describe kernel_parameter('net.ipv4.conf.default.shared_media') do\n    its(:value) { should eq 1 }\n  end\nend\n","source_location":{"line":146,"ref":"linux-baseline/controls/sysctl_spec.rb"},"waiver_data":{},"results":[{"status":"passed","code_desc":"Kernel Parameter net.ipv4.conf.all.shared_media value is expected to eq 1","run_time":0.004267727,"start_time":"2022-05-11T09:57:19+00:00","resource_class":"kernel_parameter","resource_params":"[\"net.ipv4.conf.all.shared_media\"]","resource_id":""},{"status":"passed","code_desc":"Kernel Parameter net.ipv4.conf.default.shared_media value is expected to eq 1","run_time":0.004150827,"start_time":"2022-05-11T09:57:19+00:00","resource_class":"kernel_parameter","resource_params":"[\"net.ipv4.conf.default.shared_media\"]","resource_id":""}]},{"id":"sysctl-13","title":"Disable Source Routing","desc":"The accept_source_route option causes network interfaces to accept packets with the Strict Source Route (SSR) or Loose Source Routing (LSR) option set. An attacker is able to send a source routed packet into the network, then he could intercept the replies and your server might not know that it is not communicating with a trusted server","descriptions":[{"label":"default","data":"The accept_source_route option causes network interfaces to accept packets with the Strict Source Route (SSR) or Loose Source Routing (LSR) option set. An attacker is able to send a source routed packet into the network, then he could intercept the replies and your server might not know that it is not communicating with a trusted server"}],"impact":1.0,"refs":[],"tags":{},"code":"control 'sysctl-13' do\n  impact 1.0\n  title 'Disable Source Routing'\n  desc 'The accept_source_route option causes network interfaces to accept packets with the Strict Source Route (SSR) or Loose Source Routing (LSR) option set. An attacker is able to send a source routed packet into the network, then he could intercept the replies and your server might not know that it is not communicating with a trusted server'\n  only_if { !container_execution }\n  describe kernel_parameter('net.ipv4.conf.all.accept_source_route') do\n    its(:value) { should eq 0 }\n  end\n  describe kernel_parameter('net.ipv4.conf.default.accept_source_route') do\n    its(:value) { should eq 0 }\n  end\n  describe kernel_parameter('net.ipv6.conf.all.accept_source_route') do\n    its(:value) { should eq 0 }\n  end\n  describe kernel_parameter('net.ipv6.conf.default.accept_source_route') do\n    its(:value) { should eq 0 }\n  end\nend\n","source_location":{"line":159,"ref":"linux-baseline/controls/sysctl_spec.rb"},"waiver_data":{},"results":[{"status":"passed","code_desc":"Kernel Parameter net.ipv4.conf.all.accept_source_route value is expected to eq 0","run_time":0.045393691,"start_time":"2022-05-11T09:57:19+00:00","resource_class":"kernel_parameter","resource_params":"[\"net.ipv4.conf.all.accept_source_route\"]","resource_id":""},{"status":"failed","code_desc":"Kernel Parameter net.ipv4.conf.default.accept_source_route value is expected to eq 0","run_time":0.004915432,"start_time":"2022-05-11T09:57:19+00:00","message":"\nexpected: 0\n     got: 1\n\n(compared using ==)\n","resource_class":"kernel_parameter","resource_params":"[\"net.ipv4.conf.default.accept_source_route\"]","resource_id":""},{"status":"passed","code_desc":"Kernel Parameter net.ipv6.conf.all.accept_source_route value is expected to eq 0","run_time":0.004325228,"start_time":"2022-05-11T09:57:19+00:00","resource_class":"kernel_parameter","resource_params":"[\"net.ipv6.conf.all.accept_source_route\"]","resource_id":""},{"status":"passed","code_desc":"Kernel Parameter net.ipv6.conf.default.accept_source_route value is expected to eq 0","run_time":0.00472993,"start_time":"2022-05-11T09:57:19+00:00","resource_class":"kernel_parameter","resource_params":"[\"net.ipv6.conf.default.accept_source_route\"]","resource_id":""}]},{"id":"sysctl-14","title":"Disable acceptance of all IPv4 redirected packets","desc":"Disable acceptance of all redirected packets these prevents Man-in-the-Middle attacks.","descriptions":[{"label":"default","data":"Disable acceptance of all redirected packets these prevents Man-in-the-Middle attacks."}],"impact":1.0,"refs":[],"tags":{},"code":"control 'sysctl-14' do\n  impact 1.0\n  title 'Disable acceptance of all IPv4 redirected packets'\n  desc 'Disable acceptance of all redirected packets these prevents Man-in-the-Middle attacks.'\n  only_if { !container_execution }\n  describe kernel_parameter('net.ipv4.conf.default.accept_redirects') do\n    its(:value) { should eq 0 }\n  end\n  describe kernel_parameter('net.ipv4.conf.all.accept_redirects') do\n    its(:value) { should eq 0 }\n  end\nend\n","source_location":{"line":178,"ref":"linux-baseline/controls/sysctl_spec.rb"},"waiver_data":{},"results":[{"status":"failed","code_desc":"Kernel Parameter net.ipv4.conf.default.accept_redirects value is expected to eq 0","run_time":0.00468473,"start_time":"2022-05-11T09:57:19+00:00","message":"\nexpected: 0\n     got: 1\n\n(compared using ==)\n","resource_class":"kernel_parameter","resource_params":"[\"net.ipv4.conf.default.accept_redirects\"]","resource_id":""},{"status":"failed","code_desc":"Kernel Parameter net.ipv4.conf.all.accept_redirects value is expected to eq 0","run_time":0.049127215,"start_time":"2022-05-11T09:57:19+00:00","message":"\nexpected: 0\n     got: 1\n\n(compared using ==)\n","resource_class":"kernel_parameter","resource_params":"[\"net.ipv4.conf.all.accept_redirects\"]","resource_id":""}]},{"id":"sysctl-15","title":"Disable acceptance of all secure redirected packets","desc":"Disable acceptance of all secure redirected packets these prevents Man-in-the-Middle attacks.","descriptions":[{"label":"default","data":"Disable acceptance of all secure redirected packets these prevents Man-in-the-Middle attacks."}],"impact":1.0,"refs":[],"tags":{},"code":"control 'sysctl-15' do\n  impact 1.0\n  title 'Disable acceptance of all secure redirected packets'\n  desc 'Disable acceptance of all secure redirected packets these prevents Man-in-the-Middle attacks.'\n  only_if { !container_execution }\n  describe kernel_parameter('net.ipv4.conf.all.secure_redirects') do\n    its(:value) { should eq 0 }\n  end\n  describe kernel_parameter('net.ipv4.conf.default.secure_redirects') do\n    its(:value) { should eq 0 }\n  end\nend\n","source_location":{"line":191,"ref":"linux-baseline/controls/sysctl_spec.rb"},"waiver_data":{},"results":[{"status":"failed","code_desc":"Kernel Parameter net.ipv4.conf.all.secure_redirects value is expected to eq 0","run_time":0.005557036,"start_time":"2022-05-11T09:57:19+00:00","message":"\nexpected: 0\n     got: 1\n\n(compared using ==)\n","resource_class":"kernel_parameter","resource_params":"[\"net.ipv4.conf.all.secure_redirects\"]","resource_id":""},{"status":"failed","code_desc":"Kernel Parameter net.ipv4.conf.default.secure_redirects value is expected to eq 0","run_time":0.00458033,"start_time":"2022-05-11T09:57:19+00:00","message":"\nexpected: 0\n     got: 1\n\n(compared using ==)\n","resource_class":"kernel_parameter","resource_params":"[\"net.ipv4.conf.default.secure_redirects\"]","resource_id":""}]},{"id":"sysctl-16","title":"Disable sending of redirects packets","desc":"Disable sending of redirects packets","descriptions":[{"label":"default","data":"Disable sending of redirects packets"}],"impact":1.0,"refs":[],"tags":{},"code":"control 'sysctl-16' do\n  impact 1.0\n  title 'Disable sending of redirects packets'\n  desc 'Disable sending of redirects packets'\n  only_if { !container_execution }\n  describe kernel_parameter('net.ipv4.conf.default.send_redirects') do\n    its(:value) { should eq 0 }\n  end\n  describe kernel_parameter('net.ipv4.conf.all.send_redirects') do\n    its(:value) { should eq 0 }\n  end\nend\n","source_location":{"line":204,"ref":"linux-baseline/controls/sysctl_spec.rb"},"waiver_data":{},"results":[{"status":"failed","code_desc":"Kernel Parameter net.ipv4.conf.default.send_redirects value is expected to eq 0","run_time":0.048681013,"start_time":"2022-05-11T09:57:19+00:00","message":"\nexpected: 0\n     got: 1\n\n(compared using ==)\n","resource_class":"kernel_parameter","resource_params":"[\"net.ipv4.conf.default.send_redirects\"]","resource_id":""},{"status":"failed","code_desc":"Kernel Parameter net.ipv4.conf.all.send_redirects value is expected to eq 0","run_time":0.004770931,"start_time":"2022-05-11T09:57:19+00:00","message":"\nexpected: 0\n     got: 1\n\n(compared using ==)\n","resource_class":"kernel_parameter","resource_params":"[\"net.ipv4.conf.all.send_redirects\"]","resource_id":""}]},{"id":"sysctl-17","title":"Disable log martians","desc":"log_martians can cause a denial of service attack to the host","descriptions":[{"label":"default","data":"log_martians can cause a denial of service attack to the host"}],"impact":1.0,"refs":[],"tags":{},"code":"control 'sysctl-17' do\n  impact 1.0\n  title 'Disable log martians'\n  desc 'log_martians can cause a denial of service attack to the host'\n  only_if { !container_execution }\n  describe kernel_parameter('net.ipv4.conf.all.log_martians') do\n    its(:value) { should eq 1 }\n  end\n  describe kernel_parameter('net.ipv4.conf.default.log_martians') do\n    its(:value) { should eq 1 }\n  end\nend\n","source_location":{"line":217,"ref":"linux-baseline/controls/sysctl_spec.rb"},"waiver_data":{},"results":[{"status":"failed","code_desc":"Kernel Parameter net.ipv4.conf.all.log_martians value is expected to eq 1","run_time":0.004494729,"start_time":"2022-05-11T09:57:19+00:00","message":"\nexpected: 1\n     got: 0\n\n(compared using ==)\n","resource_class":"kernel_parameter","resource_params":"[\"net.ipv4.conf.all.log_martians\"]","resource_id":""},{"status":"failed","code_desc":"Kernel Parameter net.ipv4.conf.default.log_martians value is expected to eq 1","run_time":0.004365028,"start_time":"2022-05-11T09:57:19+00:00","message":"\nexpected: 1\n     got: 0\n\n(compared using ==)\n","resource_class":"kernel_parameter","resource_params":"[\"net.ipv4.conf.default.log_martians\"]","resource_id":""}]},{"id":"sysctl-19","title":"IPv6 Forwarding","desc":"If you're not intending for your system to forward traffic between interfaces, or if you only have a single interface, the forwarding function must be disable.","descriptions":[{"label":"default","data":"If you're not intending for your system to forward traffic between interfaces, or if you only have a single interface, the forwarding function must be disable."}],"impact":1.0,"refs":[],"tags":{},"code":"control 'sysctl-19' do\n  impact 1.0\n  title 'IPv6 Forwarding'\n  desc \"If you're not intending for your system to forward traffic between interfaces, or if you only have a single interface, the forwarding function must be disable.\"\n  only_if { sysctl_forwarding == false && !container_execution }\n  describe kernel_parameter('net.ipv6.conf.all.forwarding') do\n    its(:value) { should eq 0 }\n  end\nend\n","source_location":{"line":230,"ref":"linux-baseline/controls/sysctl_spec.rb"},"waiver_data":{},"results":[{"status":"passed","code_desc":"Kernel Parameter net.ipv6.conf.all.forwarding value is expected to eq 0","run_time":0.049134415,"start_time":"2022-05-11T09:57:19+00:00","resource_class":"kernel_parameter","resource_params":"[\"net.ipv6.conf.all.forwarding\"]","resource_id":""}]},{"id":"sysctl-20","title":"Disable acceptance of all IPv6 redirected packets","desc":"Disable acceptance of all redirected packets these prevents Man-in-the-Middle attacks.","descriptions":[{"label":"default","data":"Disable acceptance of all redirected packets these prevents Man-in-the-Middle attacks."}],"impact":1.0,"refs":[],"tags":{},"code":"control 'sysctl-20' do\n  impact 1.0\n  title 'Disable acceptance of all IPv6 redirected packets'\n  desc 'Disable acceptance of all redirected packets these prevents Man-in-the-Middle attacks.'\n  only_if { !container_execution }\n  describe kernel_parameter('net.ipv6.conf.default.accept_redirects') do\n    its(:value) { should eq 0 }\n  end\n  describe kernel_parameter('net.ipv6.conf.all.accept_redirects') do\n    its(:value) { should eq 0 }\n  end\nend\n","source_location":{"line":240,"ref":"linux-baseline/controls/sysctl_spec.rb"},"waiver_data":{},"results":[{"status":"failed","code_desc":"Kernel Parameter net.ipv6.conf.default.accept_redirects value is expected to eq 0","run_time":0.004892932,"start_time":"2022-05-11T09:57:19+00:00","message":"\nexpected: 0\n     got: 1\n\n(compared using ==)\n","resource_class":"kernel_parameter","resource_params":"[\"net.ipv6.conf.default.accept_redirects\"]","resource_id":""},{"status":"failed","code_desc":"Kernel Parameter net.ipv6.conf.all.accept_redirects value is expected to eq 0","run_time":0.004484029,"start_time":"2022-05-11T09:57:19+00:00","message":"\nexpected: 0\n     got: 1\n\n(compared using ==)\n","resource_class":"kernel_parameter","resource_params":"[\"net.ipv6.conf.all.accept_redirects\"]","resource_id":""}]},{"id":"sysctl-21","title":"Disable acceptance of IPv6 router solicitations messages","desc":"The router solicitations setting determines how many router solicitations are sent when bringing up the interface. If addresses are statically assigned, there is no need to send any solicitations.","descriptions":[{"label":"default","data":"The router solicitations setting determines how many router solicitations are sent when bringing up the interface. If addresses are statically assigned, there is no need to send any solicitations."}],"impact":1.0,"refs":[],"tags":{},"code":"control 'sysctl-21' do\n  impact 1.0\n  title 'Disable acceptance of IPv6 router solicitations messages'\n  desc 'The router solicitations setting determines how many router solicitations are sent when bringing up the interface. If addresses are statically assigned, there is no need to send any solicitations.'\n  only_if { !container_execution }\n  describe kernel_parameter('net.ipv6.conf.default.router_solicitations') do\n    its(:value) { should eq 0 }\n  end\nend\n","source_location":{"line":253,"ref":"linux-baseline/controls/sysctl_spec.rb"},"waiver_data":{},"results":[{"status":"failed","code_desc":"Kernel Parameter net.ipv6.conf.default.router_solicitations value is expected to eq 0","run_time":0.004431728,"start_time":"2022-05-11T09:57:19+00:00","message":"\nexpected: 0\n     got: \"-1\"\n\n(compared using ==)\n","resource_class":"kernel_parameter","resource_params":"[\"net.ipv6.conf.default.router_solicitations\"]","resource_id":""}]},{"id":"sysctl-22","title":"Disable Accept Router Preference from router advertisement","desc":"Disable Accept Router Preference from router advertisement","descriptions":[{"label":"default","data":"Disable Accept Router Preference from router advertisement"}],"impact":1.0,"refs":[],"tags":{},"code":"control 'sysctl-22' do\n  impact 1.0\n  title 'Disable Accept Router Preference from router advertisement'\n  desc 'Disable Accept Router Preference from router advertisement'\n  only_if { !container_execution }\n  describe kernel_parameter('net.ipv6.conf.default.accept_ra_rtr_pref') do\n    its(:value) { should eq 0 }\n  end\nend\n","source_location":{"line":263,"ref":"linux-baseline/controls/sysctl_spec.rb"},"waiver_data":{},"results":[{"status":"failed","code_desc":"Kernel Parameter net.ipv6.conf.default.accept_ra_rtr_pref value is expected to eq 0","run_time":0.049551718,"start_time":"2022-05-11T09:57:19+00:00","message":"\nexpected: 0\n     got: 1\n\n(compared using ==)\n","resource_class":"kernel_parameter","resource_params":"[\"net.ipv6.conf.default.accept_ra_rtr_pref\"]","resource_id":""}]},{"id":"sysctl-23","title":"Disable learning Prefix Information from router advertisement","desc":"The accept_ra_pinfo setting controls whether the system will accept prefix info from the router.","descriptions":[{"label":"default","data":"The accept_ra_pinfo setting controls whether the system will accept prefix info from the router."}],"impact":1.0,"refs":[],"tags":{},"code":"control 'sysctl-23' do\n  impact 1.0\n  title 'Disable learning Prefix Information from router advertisement'\n  desc 'The accept_ra_pinfo setting controls whether the system will accept prefix info from the router.'\n  only_if { !container_execution }\n  describe kernel_parameter('net.ipv6.conf.default.accept_ra_pinfo') do\n    its(:value) { should eq 0 }\n  end\nend\n","source_location":{"line":273,"ref":"linux-baseline/controls/sysctl_spec.rb"},"waiver_data":{},"results":[{"status":"failed","code_desc":"Kernel Parameter net.ipv6.conf.default.accept_ra_pinfo value is expected to eq 0","run_time":0.005067832,"start_time":"2022-05-11T09:57:19+00:00","message":"\nexpected: 0\n     got: 1\n\n(compared using ==)\n","resource_class":"kernel_parameter","resource_params":"[\"net.ipv6.conf.default.accept_ra_pinfo\"]","resource_id":""}]},{"id":"sysctl-24","title":"Disable learning Hop limit from router advertisement","desc":"The accept_ra_defrtr setting controls whether the system will accept Hop Limit settings from a router advertisement. Setting it to 0 prevents a router from changing your default IPv6 Hop Limit for outgoing packets.","descriptions":[{"label":"default","data":"The accept_ra_defrtr setting controls whether the system will accept Hop Limit settings from a router advertisement. Setting it to 0 prevents a router from changing your default IPv6 Hop Limit for outgoing packets."}],"impact":1.0,"refs":[],"tags":{},"code":"control 'sysctl-24' do\n  impact 1.0\n  title 'Disable learning Hop limit from router advertisement'\n  desc 'The accept_ra_defrtr setting controls whether the system will accept Hop Limit settings from a router advertisement. Setting it to 0 prevents a router from changing your default IPv6 Hop Limit for outgoing packets.'\n  only_if { !container_execution }\n  describe kernel_parameter('net.ipv6.conf.default.accept_ra_defrtr') do\n    its(:value) { should eq 0 }\n  end\nend\n","source_location":{"line":283,"ref":"linux-baseline/controls/sysctl_spec.rb"},"waiver_data":{},"results":[{"status":"failed","code_desc":"Kernel Parameter net.ipv6.conf.default.accept_ra_defrtr value is expected to eq 0","run_time":0.00463303,"start_time":"2022-05-11T09:57:19+00:00","message":"\nexpected: 0\n     got: 1\n\n(compared using ==)\n","resource_class":"kernel_parameter","resource_params":"[\"net.ipv6.conf.default.accept_ra_defrtr\"]","resource_id":""}]},{"id":"sysctl-25","title":"Disable the system`s acceptance of router advertisement","desc":"Setting controls whether the system will accept router advertisement","descriptions":[{"label":"default","data":"Setting controls whether the system will accept router advertisement"}],"impact":1.0,"refs":[],"tags":{},"code":"control 'sysctl-25' do\n  impact 1.0\n  title 'Disable the system`s acceptance of router advertisement'\n  desc 'Setting controls whether the system will accept router advertisement'\n  only_if { !container_execution }\n  describe kernel_parameter('net.ipv6.conf.all.accept_ra') do\n    its(:value) { should eq 0 }\n  end\n  describe kernel_parameter('net.ipv6.conf.default.accept_ra') do\n    its(:value) { should eq 0 }\n  end\nend\n","source_location":{"line":293,"ref":"linux-baseline/controls/sysctl_spec.rb"},"waiver_data":{},"results":[{"status":"failed","code_desc":"Kernel Parameter net.ipv6.conf.all.accept_ra value is expected to eq 0","run_time":0.048412711,"start_time":"2022-05-11T09:57:19+00:00","message":"\nexpected: 0\n     got: 1\n\n(compared using ==)\n","resource_class":"kernel_parameter","resource_params":"[\"net.ipv6.conf.all.accept_ra\"]","resource_id":""},{"status":"failed","code_desc":"Kernel Parameter net.ipv6.conf.default.accept_ra value is expected to eq 0","run_time":0.006482741,"start_time":"2022-05-11T09:57:19+00:00","message":"\nexpected: 0\n     got: 1\n\n(compared using ==)\n","resource_class":"kernel_parameter","resource_params":"[\"net.ipv6.conf.default.accept_ra\"]","resource_id":""}]},{"id":"sysctl-26","title":"Disable IPv6 autoconfiguration","desc":"The autoconf setting controls whether router advertisements can cause the system to assign a global unicast address to an interface.","descriptions":[{"label":"default","data":"The autoconf setting controls whether router advertisements can cause the system to assign a global unicast address to an interface."}],"impact":1.0,"refs":[],"tags":{},"code":"control 'sysctl-26' do\n  impact 1.0\n  title 'Disable IPv6 autoconfiguration'\n  desc 'The autoconf setting controls whether router advertisements can cause the system to assign a global unicast address to an interface.'\n  only_if { !container_execution }\n  describe kernel_parameter('net.ipv6.conf.default.autoconf') do\n    its(:value) { should eq 0 }\n  end\nend\n","source_location":{"line":306,"ref":"linux-baseline/controls/sysctl_spec.rb"},"waiver_data":{},"results":[{"status":"failed","code_desc":"Kernel Parameter net.ipv6.conf.default.autoconf value is expected to eq 0","run_time":0.005159133,"start_time":"2022-05-11T09:57:19+00:00","message":"\nexpected: 0\n     got: 1\n\n(compared using ==)\n","resource_class":"kernel_parameter","resource_params":"[\"net.ipv6.conf.default.autoconf\"]","resource_id":""}]},{"id":"sysctl-27","title":"Disable neighbor solicitations to send out per address","desc":"The dad_transmits setting determines how many neighbor solicitations to send out per address (global and link-local) when bringing up an interface to ensure the desired address is unique on the network.","descriptions":[{"label":"default","data":"The dad_transmits setting determines how many neighbor solicitations to send out per address (global and link-local) when bringing up an interface to ensure the desired address is unique on the network."}],"impact":1.0,"refs":[],"tags":{},"code":"control 'sysctl-27' do\n  impact 1.0\n  title 'Disable neighbor solicitations to send out per address'\n  desc 'The dad_transmits setting determines how many neighbor solicitations to send out per address (global and link-local) when bringing up an interface to ensure the desired address is unique on the network.'\n  only_if { !container_execution }\n  describe kernel_parameter('net.ipv6.conf.default.dad_transmits') do\n    its(:value) { should eq 0 }\n  end\nend\n","source_location":{"line":316,"ref":"linux-baseline/controls/sysctl_spec.rb"},"waiver_data":{},"results":[{"status":"failed","code_desc":"Kernel Parameter net.ipv6.conf.default.dad_transmits value is expected to eq 0","run_time":0.006914144,"start_time":"2022-05-11T09:57:19+00:00","message":"\nexpected: 0\n     got: 1\n\n(compared using ==)\n","resource_class":"kernel_parameter","resource_params":"[\"net.ipv6.conf.default.dad_transmits\"]","resource_id":""}]},{"id":"sysctl-28","title":"Assign one global unicast IPv6 addresses to each interface","desc":"The max_addresses setting determines how many global unicast IPv6 addresses can be assigned to each interface. The default is 16, but it should be set to exactly the number of statically configured global addresses required.","descriptions":[{"label":"default","data":"The max_addresses setting determines how many global unicast IPv6 addresses can be assigned to each interface. The default is 16, but it should be set to exactly the number of statically configured global addresses required."}],"impact":1.0,"refs":[],"tags":{},"code":"control 'sysctl-28' do\n  impact 1.0\n  title 'Assign one global unicast IPv6 addresses to each interface'\n  desc 'The max_addresses setting determines how many global unicast IPv6 addresses can be assigned to each interface. The default is 16, but it should be set to exactly the number of statically configured global addresses required.'\n  only_if { !container_execution }\n  describe kernel_parameter('net.ipv6.conf.default.max_addresses') do\n    its(:value) { should eq 1 }\n  end\nend\n","source_location":{"line":326,"ref":"linux-baseline/controls/sysctl_spec.rb"},"waiver_data":{},"results":[{"status":"failed","code_desc":"Kernel Parameter net.ipv6.conf.default.max_addresses value is expected to eq 1","run_time":0.047782107,"start_time":"2022-05-11T09:57:19+00:00","message":"\nexpected: 1\n     got: 16\n\n(compared using ==)\n","resource_class":"kernel_parameter","resource_params":"[\"net.ipv6.conf.default.max_addresses\"]","resource_id":""}]},{"id":"sysctl-29","title":"Disable loading kernel modules","desc":"The sysctl key kernel.modules_disabled is very straightforward. If it contains a \"1\" it will disable loading new modules, where a \"0\" will still allow loading them. Using this option will be a great protection against loading malicious kernel modules.","descriptions":[{"label":"default","data":"The sysctl key kernel.modules_disabled is very straightforward. If it contains a \"1\" it will disable loading new modules, where a \"0\" will still allow loading them. Using this option will be a great protection against loading malicious kernel modules."}],"impact":1.0,"refs":[],"tags":{},"code":"control 'sysctl-29' do\n  impact 1.0\n  title 'Disable loading kernel modules'\n  desc 'The sysctl key kernel.modules_disabled is very straightforward. If it contains a \"1\" it will disable loading new modules, where a \"0\" will still allow loading them. Using this option will be a great protection against loading malicious kernel modules.'\n  only_if { !container_execution }\n  describe kernel_parameter('kernel.modules_disabled') do\n    its(:value) { should eq kernel_modules_disabled }\n  end\nend\n","source_location":{"line":336,"ref":"linux-baseline/controls/sysctl_spec.rb"},"waiver_data":{},"results":[{"status":"passed","code_desc":"Kernel Parameter kernel.modules_disabled value is expected to eq 0","run_time":0.004905732,"start_time":"2022-05-11T09:57:19+00:00","resource_class":"kernel_parameter","resource_params":"[\"kernel.modules_disabled\"]","resource_id":""}]},{"id":"sysctl-30","title":"Magic SysRq","desc":"Kernel.sysreg is a 'magical' key combo you can hit which the kernel will respond to regardless of whatever else it is doing, unless it is completely locked up.","descriptions":[{"label":"default","data":"Kernel.sysreg is a 'magical' key combo you can hit which the kernel will respond to regardless of whatever else it is doing, unless it is completely locked up."}],"impact":1.0,"refs":[],"tags":{},"code":"control 'sysctl-30' do\n  impact 1.0\n  title 'Magic SysRq'\n  desc \"Kernel.sysreg is a 'magical' key combo you can hit which the kernel will respond to regardless of whatever else it is doing, unless it is completely locked up.\"\n  only_if { !container_execution }\n  describe kernel_parameter('kernel.sysrq') do\n    its(:value) { should eq 0 }\n  end\nend\n","source_location":{"line":346,"ref":"linux-baseline/controls/sysctl_spec.rb"},"waiver_data":{},"results":[{"status":"failed","code_desc":"Kernel Parameter kernel.sysrq value is expected to eq 0","run_time":0.004383628,"start_time":"2022-05-11T09:57:19+00:00","message":"\nexpected: 0\n     got: 176\n\n(compared using ==)\n","resource_class":"kernel_parameter","resource_params":"[\"kernel.sysrq\"]","resource_id":""}]},{"id":"sysctl-31a","title":"Secure Core Dumps - dump settings","desc":"Ensure that core dumps can never be made by setuid programs","descriptions":[{"label":"default","data":"Ensure that core dumps can never be made by setuid programs"}],"impact":1.0,"refs":[],"tags":{},"code":"control 'sysctl-31a' do\n  impact 1.0\n  title 'Secure Core Dumps - dump settings'\n  desc 'Ensure that core dumps can never be made by setuid programs'\n  only_if { !container_execution }\n  describe kernel_parameter('fs.suid_dumpable') do\n    its(:value) { should cmp(/(0|2)/) }\n  end\nend\n","source_location":{"line":356,"ref":"linux-baseline/controls/sysctl_spec.rb"},"waiver_data":{},"results":[{"status":"passed","code_desc":"Kernel Parameter fs.suid_dumpable value is expected to cmp == /(0|2)/","run_time":0.000317702,"start_time":"2022-05-11T09:57:19+00:00","resource_class":"kernel_parameter","resource_params":"[\"fs.suid_dumpable\"]","resource_id":""}]},{"id":"sysctl-31b","title":"Secure Core Dumps - dump path","desc":"Ensure that core dumps are done with fully qualified path","descriptions":[{"label":"default","data":"Ensure that core dumps are done with fully qualified path"}],"impact":1.0,"refs":[],"tags":{},"code":"control 'sysctl-31b' do\n  impact 1.0\n  title 'Secure Core Dumps - dump path'\n  desc 'Ensure that core dumps are done with fully qualified path'\n  only_if { kernel_parameter('fs.suid_dumpable').value == 2 && !container_execution }\n  describe kernel_parameter('kernel.core_pattern') do\n    its(:value) { should match %r{^\\|?/.*} }\n  end\nend\n","source_location":{"line":366,"ref":"linux-baseline/controls/sysctl_spec.rb"},"waiver_data":{},"results":[{"status":"passed","code_desc":"Kernel Parameter kernel.core_pattern value is expected to match /^\\|?\\/.*/","run_time":0.004532829,"start_time":"2022-05-11T09:57:19+00:00","resource_class":"kernel_parameter","resource_params":"[\"kernel.core_pattern\"]","resource_id":""}]},{"id":"sysctl-32","title":"kernel.randomize_va_space","desc":"kernel.randomize_va_space","descriptions":[{"label":"default","data":"kernel.randomize_va_space"}],"impact":1.0,"refs":[],"tags":{},"code":"control 'sysctl-32' do\n  impact 1.0\n  title 'kernel.randomize_va_space'\n  desc 'kernel.randomize_va_space'\n  only_if { !container_execution }\n  describe kernel_parameter('kernel.randomize_va_space') do\n    its(:value) { should eq 2 }\n  end\nend\n","source_location":{"line":376,"ref":"linux-baseline/controls/sysctl_spec.rb"},"waiver_data":{},"results":[{"status":"passed","code_desc":"Kernel Parameter kernel.randomize_va_space value is expected to eq 2","run_time":0.048939814,"start_time":"2022-05-11T09:57:19+00:00","resource_class":"kernel_parameter","resource_params":"[\"kernel.randomize_va_space\"]","resource_id":""}]},{"id":"sysctl-33","title":"CPU No execution Flag or Kernel ExecShield","desc":"Kernel features and CPU flags provide a protection against buffer overflows. The CPU NX Flag and the kernel parameter exec-shield prevents code execution on a per memory page basis. If the CPU supports the NX-Flag then this should be used instead of the kernel parameter exec-shield.","descriptions":[{"label":"default","data":"Kernel features and CPU flags provide a protection against buffer overflows. The CPU NX Flag and the kernel parameter exec-shield prevents code execution on a per memory page basis. If the CPU supports the NX-Flag then this should be used instead of the kernel parameter exec-shield."}],"impact":1.0,"refs":[],"tags":{},"code":"control 'sysctl-33' do\n  impact 1.0\n  title 'CPU No execution Flag or Kernel ExecShield'\n  desc 'Kernel features and CPU flags provide a protection against buffer overflows. The CPU NX Flag and the kernel parameter exec-shield prevents code execution on a per memory page basis. If the CPU supports the NX-Flag then this should be used instead of the kernel parameter exec-shield.'\n  only_if { !container_execution }\n\n  # parse for cpu flags\n  flags = parse_config_file('/proc/cpuinfo', assignment_regex: /^([^:]*?)\\s+:\\s+(.*?)$/).flags\n  flags ||= ''\n  flags = flags.split(' ')\n\n  describe '/proc/cpuinfo' do\n    it 'Flags should include NX' do\n      expect(flags).to include('nx')\n    end\n  end\n\n  unless flags.include?('nx')\n    # if no nx flag is present, we require exec-shield\n    describe kernel_parameter('kernel.exec-shield') do\n      its(:value) { should eq 1 }\n    end\n  end\nend\n","source_location":{"line":386,"ref":"linux-baseline/controls/sysctl_spec.rb"},"waiver_data":{},"results":[{"status":"passed","code_desc":"/proc/cpuinfo Flags should include NX","run_time":0.000142301,"start_time":"2022-05-11T09:57:19+00:00","resource_class":"Object","resource_params":"[]","resource_id":"/proc/cpuinfo"}]},{"id":"sysctl-34","title":"Ensure links are protected","desc":"Protects against common exploits in regards to links, fifos and regular files created or controlled by attackers","descriptions":[{"label":"default","data":"Protects against common exploits in regards to links, fifos and regular files created or controlled by attackers"}],"impact":1.0,"refs":[],"tags":{},"code":"control 'sysctl-34' do\n  impact 1.0\n  title 'Ensure links are protected'\n  desc 'Protects against common exploits in regards to links, fifos and regular files created or controlled by attackers'\n  only_if { !container_execution }\n  describe kernel_parameter('fs.protected_fifos') do\n    its(:value) { should match cmp(/(1|2)/) }\n  end\n  describe kernel_parameter('fs.protected_hardlinks') do\n    its(:value) { should eq 1 }\n  end\n  describe kernel_parameter('fs.protected_regular') do\n    its(:value) { should eq 2 }\n  end\n  describe kernel_parameter('fs.protected_symlinks') do\n    its(:value) { should eq 1 }\n  end\nend\n","source_location":{"line":411,"ref":"linux-baseline/controls/sysctl_spec.rb"},"waiver_data":{},"results":[{"status":"passed","code_desc":"Kernel Parameter fs.protected_fifos value is expected to match (cmp  nil)","run_time":0.004991832,"start_time":"2022-05-11T09:57:19+00:00","resource_class":"kernel_parameter","resource_params":"[\"fs.protected_fifos\"]","resource_id":""},{"status":"failed","code_desc":"Kernel Parameter fs.protected_hardlinks value is expected to eq 1","run_time":0.004476929,"start_time":"2022-05-11T09:57:19+00:00","message":"\nexpected: 1\n     got: nil\n\n(compared using ==)\n","resource_class":"kernel_parameter","resource_params":"[\"fs.protected_hardlinks\"]","resource_id":""},{"status":"failed","code_desc":"Kernel Parameter fs.protected_regular value is expected to eq 2","run_time":0.004241927,"start_time":"2022-05-11T09:57:19+00:00","message":"\nexpected: 2\n     got: nil\n\n(compared using ==)\n","resource_class":"kernel_parameter","resource_params":"[\"fs.protected_regular\"]","resource_id":""},{"status":"failed","code_desc":"Kernel Parameter fs.protected_symlinks value is expected to eq 1","run_time":0.049144215,"start_time":"2022-05-11T09:57:19+00:00","message":"\nexpected: 1\n     got: nil\n\n(compared using ==)\n","resource_class":"kernel_parameter","resource_params":"[\"fs.protected_symlinks\"]","resource_id":""}]}],"status":"loaded","status_message":""}],"statistics":{"duration":1.937004619},"version":"5.14.0"}